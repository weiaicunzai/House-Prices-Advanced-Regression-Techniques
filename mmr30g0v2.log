nohup: 忽略输入
/home/baiyu/miniconda3/bin/conda
/home/baiyu/miniconda3/envs/torch1.13/lib/python3.10/site-packages/numpy/__init__.py
/home/xuxinan/mmCode2/unet3.py:111: UserWarning: 250unet_xor.png is a low contrast image
  imsave(f'{rate}unet_xor.png', ans)
ok
args:  Namespace(b=8, lr=0.004, e=120, iter=2000, eval_iter=100, wd=0.0001, resume=False, net='tgt', dataset='Glas', prefix='unet_branch_SGD_473', alpha=0.1, op='or', download=True, gpu=True, baseline=False, pretrain=False, poly=True, min_lr=0.0004, branch='hybird', fp16=True, wait=False, vis=False, imgset='train', rate=25)
saving tensorboard log into /home/xuxinan/mmCode2/runs/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s
img_set train
Glas : data_folder: /data/hdd1/by/House-Prices-Advanced-Regression-Techniques/data/Warwick QU Dataset (Released 2016_07_08)
search_path: /data/hdd1/by/House-Prices-Advanced-Regression-Techniques/data/Warwick QU Dataset (Released 2016_07_08)/**/*.bmp
Glas:label_re train_[0-9]+_anno\.bmp

train
Glas : data_folder: /data/hdd1/by/House-Prices-Advanced-Regression-Techniques/data/Warwick QU Dataset (Released 2016_07_08)
search_path: /data/hdd1/by/House-Prices-Advanced-Regression-Techniques/data/Warwick QU Dataset (Released 2016_07_08)/**/*.bmp
Glas:label_re val_[0-9]+_anno\.bmp

val

TG(
  (backbone): ResNet(
    (conv1): Sequential(
      (0): Conv2d(3, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
      (3): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (5): ReLU(inplace=True)
      (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (act1): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (1): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
        (downsample): Sequential(
          (0): AvgPool2d(kernel_size=2, stride=2, padding=0)
          (1): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (3): BasicBlock(
        (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Identity()
          (1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (3): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (4): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (5): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Identity()
          (1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2), dilation=(2, 2), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(4, 4), dilation=(4, 4), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
    )
    (global_pool): Identity()
    (fc): Identity()
  )
  (project): Sequential(
    (0): Conv2d(64, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (1): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (classifier): Sequential(
    (0): Conv2d(112, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 2, kernel_size=(1, 1), stride=(1, 1))
  )
  (fcs): ModuleList(
    (0): BasicLinear(
      (fc): Sequential(
        (0): Linear(in_features=64, out_features=64, bias=True)
      )
    )
    (1): BasicLinear(
      (fc): Sequential(
        (0): Linear(in_features=128, out_features=64, bias=True)
      )
    )
    (2): BasicLinear(
      (fc): Sequential(
        (0): Linear(in_features=256, out_features=64, bias=True)
      )
    )
    (3): BasicLinear(
      (fc): Sequential(
        (0): Linear(in_features=512, out_features=64, bias=True)
      )
    )
  )
  (gland_head_project): Sequential(
    (0): BasicConv2d(
      (conv): Sequential(
        (0): Conv2d(512, 64, kernel_size=(1, 1), stride=(1, 1))
        (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
      )
    )
  )
  (aux_head): Sequential(
    (0): BasicConv2d(
      (conv): Sequential(
        (0): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1))
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
      )
    )
    (1): BasicConv2d(
      (conv): Sequential(
        (0): Conv2d(128, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): BatchNorm2d(2, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
      )
    )
  )
)

train:ckpt_path: /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s
GlandContrastLoss 4
rate:25
/home/baiyu/miniconda3/envs/torch1.13/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:138: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/home/xuxinan/mmCode2/losses/loss.py:265: RuntimeWarning: invalid value encountered in divide
  w = w / w.max()
Training Iter: [50/2000] Lr:0.001000 Total Loss:0.7908, Iter time:0.6533s Data loading time:0.0002s
Training Iter: [100/2000] Lr:0.002000 Total Loss:0.7822, Iter time:0.8392s Data loading time:0.0006s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:56, 12.46s/it] 10%|█         | 2/20 [00:20<02:55,  9.73s/it]/home/baiyu/miniconda3/envs/torch1.13/lib/python3.10/site-packages/skimage/_shared/utils.py:157: UserWarning: Only one label was provided to `remove_small_objects`. Did you mean to use a boolean array?
  return func(*args, **kwargs)
 15%|█▌        | 3/20 [00:52<05:39, 19.98s/it] 20%|██        | 4/20 [01:18<06:00, 22.56s/it] 25%|██▌       | 5/20 [01:43<05:50, 23.37s/it] 30%|███       | 6/20 [01:50<04:08, 17.76s/it] 35%|███▌      | 7/20 [02:13<04:10, 19.26s/it] 40%|████      | 8/20 [02:27<03:33, 17.82s/it] 45%|████▌     | 9/20 [02:36<02:45, 15.03s/it] 50%|█████     | 10/20 [02:49<02:22, 14.21s/it] 55%|█████▌    | 11/20 [03:06<02:18, 15.36s/it] 60%|██████    | 12/20 [03:19<01:57, 14.65s/it] 65%|██████▌   | 13/20 [03:29<01:31, 13.08s/it] 70%|███████   | 14/20 [03:39<01:12, 12.03s/it] 75%|███████▌  | 15/20 [03:46<00:53, 10.62s/it] 80%|████████  | 16/20 [03:54<00:39,  9.94s/it] 85%|████████▌ | 17/20 [04:03<00:29,  9.68s/it] 90%|█████████ | 18/20 [04:12<00:18,  9.35s/it] 95%|█████████▌| 19/20 [04:22<00:09,  9.52s/it]100%|██████████| 20/20 [04:37<00:00, 11.12s/it]100%|██████████| 20/20 [04:37<00:00, 13.86s/it]
total: F1 0.8788207729938236, Dice:0.8956814870106907, Haus:55.37694449389902
testA: F1 0.9163086109877461, Dice:0.9173127293096376, Haus:34.54711768363887
testB: F1 0.7663572590120578, Dice:0.8307877601138507, Haus:117.86642492467936
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_F1_0.8788_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Dice_0.8957_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Haus_55.3769_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_F1_0.9163_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Dice_0.9173_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Haus_34.5471_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_F1_0.7664_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_Dice_0.8308_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_Haus_117.8664_iter_99.pt
best value: {'total_F1': 0.8788207729938236, 'total_Dice': 0.8956814870106907, 'total_Haus': 55.37694449389902, 'testA_F1': 0.9163086109877461, 'testA_Dice': 0.9173127293096376, 'testA_Haus': 34.54711768363887, 'testB_F1': 0.7663572590120578, 'testB_Dice': 0.8307877601138507, 'testB_Haus': 117.86642492467936}
Training Iter: [150/2000] Lr:0.003000 Total Loss:0.6486, Iter time:0.9190s Data loading time:0.0001s
/home/xuxinan/mmCode2/losses/loss.py:324: RuntimeWarning: invalid value encountered in divide
  w = w / w.max()
Training Iter: [200/2000] Lr:0.004000 Total Loss:0.7980, Iter time:0.6545s Data loading time:0.0003s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<03:03,  9.65s/it] 10%|█         | 2/20 [00:17<02:38,  8.78s/it] 15%|█▌        | 3/20 [00:42<04:31, 15.97s/it] 20%|██        | 4/20 [00:57<04:12, 15.76s/it] 25%|██▌       | 5/20 [01:14<04:00, 16.02s/it] 30%|███       | 6/20 [01:19<02:51, 12.21s/it] 35%|███▌      | 7/20 [01:29<02:32, 11.73s/it] 40%|████      | 8/20 [01:40<02:18, 11.55s/it] 45%|████▌     | 9/20 [01:47<01:51, 10.13s/it] 50%|█████     | 10/20 [01:56<01:37,  9.74s/it] 55%|█████▌    | 11/20 [02:13<01:45, 11.75s/it] 60%|██████    | 12/20 [02:25<01:34, 11.86s/it] 65%|██████▌   | 13/20 [02:32<01:13, 10.51s/it] 70%|███████   | 14/20 [02:39<00:57,  9.51s/it] 75%|███████▌  | 15/20 [02:45<00:41,  8.21s/it] 80%|████████  | 16/20 [02:52<00:31,  7.94s/it] 85%|████████▌ | 17/20 [02:58<00:21,  7.33s/it] 90%|█████████ | 18/20 [03:04<00:14,  7.13s/it] 95%|█████████▌| 19/20 [03:12<00:07,  7.23s/it]100%|██████████| 20/20 [03:23<00:00,  8.28s/it]100%|██████████| 20/20 [03:23<00:00, 10.16s/it]
total: F1 0.8721057460396681, Dice:0.8960986961928186, Haus:53.406158018405435
testA: F1 0.9081308549911521, Dice:0.9156361397579881, Haus:36.06512776332694
testB: F1 0.7640304191852181, Dice:0.8374863654973105, Haus:105.42924878364087
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_199.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Dice_0.8961_iter_199.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Dice_0.8957_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Haus_53.4062_iter_199.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Haus_55.3769_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_Dice_0.8375_iter_199.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_Dice_0.8308_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_Haus_105.4292_iter_199.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_Haus_117.8664_iter_99.pt
best value: {'total_F1': 0.8788207729938236, 'total_Dice': 0.8960986961928186, 'total_Haus': 53.406158018405435, 'testA_F1': 0.9163086109877461, 'testA_Dice': 0.9173127293096376, 'testA_Haus': 34.54711768363887, 'testB_F1': 0.7663572590120578, 'testB_Dice': 0.8374863654973105, 'testB_Haus': 105.42924878364087}
Training Iter: [250/2000] Lr:0.003910 Total Loss:0.9326, Iter time:0.7776s Data loading time:0.0007s
Training Iter: [300/2000] Lr:0.003819 Total Loss:0.7370, Iter time:0.6869s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:11, 10.07s/it] 10%|█         | 2/20 [00:18<02:42,  9.02s/it] 15%|█▌        | 3/20 [00:45<04:54, 17.32s/it] 20%|██        | 4/20 [01:06<05:02, 18.90s/it] 25%|██▌       | 5/20 [01:22<04:27, 17.85s/it] 30%|███       | 6/20 [01:27<03:09, 13.52s/it] 35%|███▌      | 7/20 [01:42<03:00, 13.87s/it] 40%|████      | 8/20 [01:54<02:37, 13.14s/it] 45%|████▌     | 9/20 [02:01<02:03, 11.19s/it] 50%|█████     | 10/20 [02:10<01:45, 10.54s/it] 55%|█████▌    | 11/20 [02:22<01:39, 11.10s/it] 60%|██████    | 12/20 [02:34<01:31, 11.38s/it] 65%|██████▌   | 13/20 [02:40<01:08,  9.83s/it] 70%|███████   | 14/20 [02:47<00:53,  8.89s/it] 75%|███████▌  | 15/20 [02:54<00:41,  8.21s/it] 80%|████████  | 16/20 [03:01<00:31,  7.99s/it] 85%|████████▌ | 17/20 [03:08<00:22,  7.56s/it] 90%|█████████ | 18/20 [03:14<00:14,  7.33s/it] 95%|█████████▌| 19/20 [03:23<00:07,  7.54s/it]100%|██████████| 20/20 [03:34<00:00,  8.71s/it]100%|██████████| 20/20 [03:34<00:00, 10.72s/it]
total: F1 0.8813150950101765, Dice:0.8849616424399993, Haus:56.28985019860296
testA: F1 0.9074610370369353, Dice:0.9027649555587921, Haus:39.21229290903078
testB: F1 0.8028772689299005, Dice:0.8315517030836224, Haus:107.5225220673195
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_299.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_F1_0.8813_iter_299.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_F1_0.8788_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_F1_0.8029_iter_299.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_F1_0.7664_iter_99.pt
best value: {'total_F1': 0.8813150950101765, 'total_Dice': 0.8960986961928186, 'total_Haus': 53.406158018405435, 'testA_F1': 0.9163086109877461, 'testA_Dice': 0.9173127293096376, 'testA_Haus': 34.54711768363887, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8374863654973105, 'testB_Haus': 105.42924878364087}
Training Iter: [350/2000] Lr:0.003729 Total Loss:0.9622, Iter time:0.8815s Data loading time:0.0002s
Training Iter: [400/2000] Lr:0.003638 Total Loss:0.7724, Iter time:0.5852s Data loading time:0.0014s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:10, 10.01s/it] 10%|█         | 2/20 [00:15<02:13,  7.43s/it] 15%|█▌        | 3/20 [00:32<03:20, 11.80s/it] 20%|██        | 4/20 [00:52<03:59, 14.94s/it] 25%|██▌       | 5/20 [01:08<03:50, 15.34s/it] 30%|███       | 6/20 [01:14<02:48, 12.05s/it] 35%|███▌      | 7/20 [01:27<02:44, 12.62s/it] 40%|████      | 8/20 [01:34<02:10, 10.84s/it] 45%|████▌     | 9/20 [01:42<01:46,  9.70s/it] 50%|█████     | 10/20 [01:50<01:32,  9.21s/it] 55%|█████▌    | 11/20 [02:06<01:41, 11.23s/it] 60%|██████    | 12/20 [02:18<01:33, 11.68s/it] 65%|██████▌   | 13/20 [02:25<01:11, 10.21s/it] 70%|███████   | 14/20 [02:32<00:56,  9.35s/it] 75%|███████▌  | 15/20 [02:39<00:42,  8.40s/it] 80%|████████  | 16/20 [02:45<00:31,  7.84s/it] 85%|████████▌ | 17/20 [02:52<00:22,  7.47s/it] 90%|█████████ | 18/20 [02:59<00:14,  7.34s/it] 95%|█████████▌| 19/20 [03:09<00:08,  8.22s/it]100%|██████████| 20/20 [03:22<00:00,  9.51s/it]100%|██████████| 20/20 [03:22<00:00, 10.11s/it]
total: F1 0.8828495296867143, Dice:0.8984534973554963, Haus:52.802841855615824
testA: F1 0.9136855199070292, Dice:0.9180537803605937, Haus:34.47097779115973
testB: F1 0.7903415590257696, Dice:0.8396526483402054, Haus:107.79843404898409
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_399.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_F1_0.8828_iter_399.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_F1_0.8813_iter_299.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Dice_0.8985_iter_399.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Dice_0.8961_iter_199.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Haus_52.8028_iter_399.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Haus_53.4062_iter_199.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Dice_0.9181_iter_399.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Dice_0.9173_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Haus_34.4710_iter_399.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Haus_34.5471_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_Dice_0.8397_iter_399.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_Dice_0.8375_iter_199.pt
best value: {'total_F1': 0.8828495296867143, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.802841855615824, 'testA_F1': 0.9163086109877461, 'testA_Dice': 0.9180537803605937, 'testA_Haus': 34.47097779115973, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [450/2000] Lr:0.003547 Total Loss:0.6223, Iter time:7.9089s Data loading time:7.0382s
Training Iter: [500/2000] Lr:0.003455 Total Loss:0.7360, Iter time:0.8856s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:35, 11.36s/it] 10%|█         | 2/20 [00:19<02:52,  9.61s/it] 15%|█▌        | 3/20 [00:39<04:01, 14.23s/it] 20%|██        | 4/20 [01:08<05:19, 19.97s/it] 25%|██▌       | 5/20 [01:26<04:52, 19.47s/it] 30%|███       | 6/20 [01:32<03:26, 14.78s/it] 35%|███▌      | 7/20 [01:50<03:24, 15.70s/it] 40%|████      | 8/20 [02:02<02:55, 14.65s/it] 45%|████▌     | 9/20 [02:10<02:17, 12.48s/it] 50%|█████     | 10/20 [02:18<01:52, 11.24s/it] 55%|█████▌    | 11/20 [02:34<01:53, 12.66s/it] 60%|██████    | 12/20 [02:52<01:53, 14.13s/it] 65%|██████▌   | 13/20 [03:01<01:28, 12.58s/it] 70%|███████   | 14/20 [03:11<01:11, 11.99s/it] 75%|███████▌  | 15/20 [03:17<00:51, 10.22s/it] 80%|████████  | 16/20 [03:25<00:37,  9.32s/it] 85%|████████▌ | 17/20 [03:33<00:27,  9.00s/it] 90%|█████████ | 18/20 [03:40<00:16,  8.44s/it] 95%|█████████▌| 19/20 [03:49<00:08,  8.66s/it]100%|██████████| 20/20 [04:03<00:00, 10.09s/it]100%|██████████| 20/20 [04:03<00:00, 12.15s/it]
total: F1 0.8757140005302757, Dice:0.8929993548605154, Haus:54.83525902327176
testA: F1 0.9138764519867493, Dice:0.9156215539734137, Haus:35.92994556193216
testB: F1 0.7612266461608568, Dice:0.8251327575218204, Haus:111.55119940729051
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_499.pt
best value: {'total_F1': 0.8828495296867143, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.802841855615824, 'testA_F1': 0.9163086109877461, 'testA_Dice': 0.9180537803605937, 'testA_Haus': 34.47097779115973, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [550/2000] Lr:0.003363 Total Loss:0.6943, Iter time:0.5723s Data loading time:0.0002s
Training Iter: [600/2000] Lr:0.003271 Total Loss:0.7397, Iter time:0.6107s Data loading time:0.0042s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:23, 10.72s/it] 10%|█         | 2/20 [00:18<02:41,  8.97s/it] 15%|█▌        | 3/20 [00:34<03:30, 12.38s/it] 20%|██        | 4/20 [00:49<03:32, 13.27s/it] 25%|██▌       | 5/20 [01:08<03:48, 15.26s/it] 30%|███       | 6/20 [01:13<02:46, 11.89s/it] 35%|███▌      | 7/20 [01:23<02:26, 11.25s/it] 40%|████      | 8/20 [01:35<02:15, 11.33s/it] 45%|████▌     | 9/20 [01:41<01:49,  9.93s/it] 50%|█████     | 10/20 [01:52<01:41, 10.15s/it] 55%|█████▌    | 11/20 [02:10<01:53, 12.64s/it] 60%|██████    | 12/20 [02:24<01:43, 12.88s/it] 65%|██████▌   | 13/20 [02:31<01:17, 11.04s/it] 70%|███████   | 14/20 [02:38<01:00, 10.01s/it] 75%|███████▌  | 15/20 [02:44<00:43,  8.72s/it] 80%|████████  | 16/20 [02:51<00:33,  8.29s/it] 85%|████████▌ | 17/20 [02:58<00:23,  7.69s/it] 90%|█████████ | 18/20 [03:04<00:14,  7.42s/it] 95%|█████████▌| 19/20 [03:13<00:07,  7.68s/it]100%|██████████| 20/20 [03:25<00:00,  8.98s/it]100%|██████████| 20/20 [03:25<00:00, 10.26s/it]
total: F1 0.8678741989868863, Dice:0.89170830621881, Haus:58.687591485134966
testA: F1 0.9085863058516234, Dice:0.9138451488995211, Haus:39.14496734049113
testB: F1 0.7457378783926771, Dice:0.8252977781766765, Haus:117.31546391906645
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_599.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_99.pt
best value: {'total_F1': 0.8828495296867143, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.802841855615824, 'testA_F1': 0.9163086109877461, 'testA_Dice': 0.9180537803605937, 'testA_Haus': 34.47097779115973, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [650/2000] Lr:0.003179 Total Loss:0.7889, Iter time:0.5458s Data loading time:0.0002s
Training Iter: [700/2000] Lr:0.003086 Total Loss:0.7255, Iter time:0.5356s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:53, 12.27s/it] 10%|█         | 2/20 [00:19<02:43,  9.06s/it] 15%|█▌        | 3/20 [00:58<06:30, 23.00s/it] 20%|██        | 4/20 [01:20<06:01, 22.60s/it] 25%|██▌       | 5/20 [01:38<05:14, 21.00s/it] 30%|███       | 6/20 [01:43<03:37, 15.56s/it] 35%|███▌      | 7/20 [01:56<03:09, 14.60s/it] 40%|████      | 8/20 [02:04<02:29, 12.49s/it] 45%|████▌     | 9/20 [02:11<01:59, 10.86s/it] 50%|█████     | 10/20 [02:21<01:44, 10.42s/it] 55%|█████▌    | 11/20 [02:37<01:50, 12.24s/it] 60%|██████    | 12/20 [02:49<01:38, 12.30s/it] 65%|██████▌   | 13/20 [02:57<01:16, 10.94s/it] 70%|███████   | 14/20 [03:05<01:00, 10.04s/it] 75%|███████▌  | 15/20 [03:11<00:43,  8.73s/it] 80%|████████  | 16/20 [03:19<00:34,  8.56s/it] 85%|████████▌ | 17/20 [03:28<00:25,  8.64s/it] 90%|█████████ | 18/20 [03:35<00:16,  8.24s/it] 95%|█████████▌| 19/20 [03:45<00:08,  8.65s/it]100%|██████████| 20/20 [03:59<00:00, 10.32s/it]100%|██████████| 20/20 [03:59<00:00, 11.98s/it]
total: F1 0.8783003050769169, Dice:0.8948874509624524, Haus:56.05594872688223
testA: F1 0.9244649693995749, Dice:0.9174213032049625, Haus:36.104310654078596
testB: F1 0.7398063121089438, Dice:0.8272858942349222, Haus:115.91086294529312
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_699.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_199.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_F1_0.9245_iter_699.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_F1_0.9163_iter_99.pt
best value: {'total_F1': 0.8828495296867143, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.802841855615824, 'testA_F1': 0.9244649693995749, 'testA_Dice': 0.9180537803605937, 'testA_Haus': 34.47097779115973, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [750/2000] Lr:0.002993 Total Loss:0.6416, Iter time:1.6407s Data loading time:1.0490s
Training Iter: [800/2000] Lr:0.002899 Total Loss:0.8065, Iter time:0.7539s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<03:08,  9.93s/it] 10%|█         | 2/20 [00:18<02:39,  8.88s/it] 15%|█▌        | 3/20 [00:44<04:46, 16.87s/it] 20%|██        | 4/20 [00:58<04:11, 15.70s/it] 25%|██▌       | 5/20 [01:14<04:00, 16.03s/it] 30%|███       | 6/20 [01:19<02:48, 12.06s/it] 35%|███▌      | 7/20 [01:30<02:33, 11.84s/it] 40%|████      | 8/20 [01:41<02:16, 11.40s/it] 45%|████▌     | 9/20 [01:49<01:54, 10.40s/it] 50%|█████     | 10/20 [01:56<01:33,  9.33s/it] 55%|█████▌    | 11/20 [02:12<01:43, 11.51s/it] 60%|██████    | 12/20 [02:26<01:37, 12.14s/it] 65%|██████▌   | 13/20 [02:34<01:16, 10.95s/it] 70%|███████   | 14/20 [02:41<00:59,  9.88s/it] 75%|███████▌  | 15/20 [02:47<00:43,  8.60s/it] 80%|████████  | 16/20 [02:55<00:33,  8.38s/it] 85%|████████▌ | 17/20 [03:02<00:24,  8.08s/it] 90%|█████████ | 18/20 [03:10<00:16,  8.02s/it] 95%|█████████▌| 19/20 [03:18<00:07,  7.95s/it]100%|██████████| 20/20 [03:28<00:00,  8.48s/it]100%|██████████| 20/20 [03:28<00:00, 10.41s/it]
total: F1 0.8823799283468435, Dice:0.894655300562224, Haus:54.81658537160608
testA: F1 0.9159051939488008, Dice:0.9156948614887122, Haus:35.902197521694916
testB: F1 0.7818041315409736, Dice:0.8315366177827596, Haus:111.55974892133975
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_799.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_299.pt
best value: {'total_F1': 0.8828495296867143, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.802841855615824, 'testA_F1': 0.9244649693995749, 'testA_Dice': 0.9180537803605937, 'testA_Haus': 34.47097779115973, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [850/2000] Lr:0.002805 Total Loss:0.7742, Iter time:0.5171s Data loading time:0.0044s
Training Iter: [900/2000] Lr:0.002711 Total Loss:0.6862, Iter time:0.6596s Data loading time:0.0018s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:31, 11.14s/it] 10%|█         | 2/20 [00:19<02:47,  9.33s/it] 15%|█▌        | 3/20 [00:39<04:02, 14.26s/it] 20%|██        | 4/20 [01:03<04:47, 17.98s/it] 25%|██▌       | 5/20 [01:20<04:25, 17.68s/it] 30%|███       | 6/20 [01:25<03:09, 13.55s/it] 35%|███▌      | 7/20 [01:43<03:12, 14.84s/it] 40%|████      | 8/20 [01:56<02:53, 14.46s/it] 45%|████▌     | 9/20 [02:04<02:15, 12.30s/it] 50%|█████     | 10/20 [02:14<01:56, 11.66s/it] 55%|█████▌    | 11/20 [02:26<01:46, 11.82s/it] 60%|██████    | 12/20 [02:41<01:42, 12.84s/it] 65%|██████▌   | 13/20 [02:50<01:20, 11.44s/it] 70%|███████   | 14/20 [02:58<01:02, 10.49s/it] 75%|███████▌  | 15/20 [03:03<00:44,  8.83s/it] 80%|████████  | 16/20 [03:10<00:32,  8.17s/it] 85%|████████▌ | 17/20 [03:16<00:22,  7.52s/it] 90%|█████████ | 18/20 [03:22<00:14,  7.15s/it] 95%|█████████▌| 19/20 [03:31<00:07,  7.76s/it]100%|██████████| 20/20 [03:43<00:00,  8.98s/it]100%|██████████| 20/20 [03:43<00:00, 11.17s/it]
total: F1 0.8918699456745467, Dice:0.898260244571393, Haus:52.822746050852196
testA: F1 0.925463988715325, Dice:0.9191130761639361, Haus:33.845239963563664
testB: F1 0.7910878165522128, Dice:0.8357017497937631, Haus:109.75526431271774
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_899.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_399.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_F1_0.8919_iter_899.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_F1_0.8828_iter_399.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_F1_0.9255_iter_899.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_F1_0.9245_iter_699.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Dice_0.9191_iter_899.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Dice_0.9181_iter_399.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Haus_33.8452_iter_899.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Haus_34.4710_iter_399.pt
best value: {'total_F1': 0.8918699456745467, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.802841855615824, 'testA_F1': 0.925463988715325, 'testA_Dice': 0.9191130761639361, 'testA_Haus': 33.845239963563664, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [950/2000] Lr:0.002616 Total Loss:0.9319, Iter time:1.0327s Data loading time:0.0002s
Training Iter: [1000/2000] Lr:0.002521 Total Loss:0.5455, Iter time:0.5914s Data loading time:0.0022s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:55, 12.37s/it] 10%|█         | 2/20 [00:20<02:53,  9.63s/it] 15%|█▌        | 3/20 [00:44<04:36, 16.26s/it] 20%|██        | 4/20 [00:59<04:14, 15.91s/it] 25%|██▌       | 5/20 [01:15<04:00, 16.01s/it] 30%|███       | 6/20 [01:20<02:52, 12.33s/it] 35%|███▌      | 7/20 [01:31<02:30, 11.58s/it] 40%|████      | 8/20 [01:43<02:22, 11.90s/it] 45%|████▌     | 9/20 [01:51<01:56, 10.58s/it] 50%|█████     | 10/20 [02:00<01:43, 10.31s/it] 55%|█████▌    | 11/20 [02:19<01:55, 12.83s/it] 60%|██████    | 12/20 [02:33<01:45, 13.19s/it] 65%|██████▌   | 13/20 [02:40<01:18, 11.21s/it] 70%|███████   | 14/20 [02:48<01:01, 10.26s/it] 75%|███████▌  | 15/20 [02:53<00:44,  8.88s/it] 80%|████████  | 16/20 [03:01<00:33,  8.33s/it] 85%|████████▌ | 17/20 [03:07<00:23,  7.86s/it] 90%|█████████ | 18/20 [03:14<00:15,  7.54s/it] 95%|█████████▌| 19/20 [03:21<00:07,  7.50s/it]100%|██████████| 20/20 [03:33<00:00,  8.61s/it]100%|██████████| 20/20 [03:33<00:00, 10.66s/it]
total: F1 0.8968436999955998, Dice:0.8975986742431221, Haus:54.23188710067144
testA: F1 0.9316684066526738, Dice:0.9211579811266724, Haus:34.488027950643804
testB: F1 0.7923695800243789, Dice:0.826920753592472, Haus:113.46346455075437
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_999.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_499.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_F1_0.8968_iter_999.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_F1_0.8919_iter_899.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_F1_0.9317_iter_999.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_F1_0.9255_iter_899.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Dice_0.9212_iter_999.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Dice_0.9191_iter_899.pt
best value: {'total_F1': 0.8968436999955998, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.802841855615824, 'testA_F1': 0.9316684066526738, 'testA_Dice': 0.9211579811266724, 'testA_Haus': 33.845239963563664, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [1050/2000] Lr:0.002425 Total Loss:0.6907, Iter time:0.6918s Data loading time:0.0003s
Training Iter: [1100/2000] Lr:0.002329 Total Loss:0.7644, Iter time:1.1215s Data loading time:0.0001s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:34, 11.27s/it] 10%|█         | 2/20 [00:20<02:59,  9.99s/it] 15%|█▌        | 3/20 [00:49<05:14, 18.51s/it] 20%|██        | 4/20 [01:13<05:31, 20.74s/it] 25%|██▌       | 5/20 [01:30<04:53, 19.60s/it] 30%|███       | 6/20 [01:35<03:26, 14.72s/it] 35%|███▌      | 7/20 [01:52<03:18, 15.24s/it] 40%|████      | 8/20 [02:04<02:52, 14.33s/it] 45%|████▌     | 9/20 [02:13<02:18, 12.58s/it] 50%|█████     | 10/20 [02:23<01:58, 11.85s/it] 55%|█████▌    | 11/20 [02:42<02:07, 14.13s/it] 60%|██████    | 12/20 [02:56<01:51, 13.99s/it] 65%|██████▌   | 13/20 [03:04<01:25, 12.22s/it] 70%|███████   | 14/20 [03:13<01:07, 11.19s/it] 75%|███████▌  | 15/20 [03:19<00:48,  9.67s/it] 80%|████████  | 16/20 [03:28<00:37,  9.31s/it] 85%|████████▌ | 17/20 [03:37<00:27,  9.21s/it] 90%|█████████ | 18/20 [03:45<00:17,  8.85s/it] 95%|█████████▌| 19/20 [03:55<00:09,  9.26s/it]100%|██████████| 20/20 [04:08<00:00, 10.47s/it]100%|██████████| 20/20 [04:08<00:00, 12.43s/it]
total: F1 0.8786166059404291, Dice:0.8959503421054759, Haus:52.77803933843542
testA: F1 0.9237016097386378, Dice:0.9158990331240022, Haus:34.30315121104077
testB: F1 0.7433615945458051, Dice:0.8361042690498965, Haus:108.20270372061937
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1099.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_599.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Haus_52.7780_iter_1099.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Haus_52.8028_iter_399.pt
best value: {'total_F1': 0.8968436999955998, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.77803933843542, 'testA_F1': 0.9316684066526738, 'testA_Dice': 0.9211579811266724, 'testA_Haus': 33.845239963563664, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [1150/2000] Lr:0.002232 Total Loss:0.6162, Iter time:0.5798s Data loading time:0.0002s
Training Iter: [1200/2000] Lr:0.002135 Total Loss:0.7220, Iter time:0.8217s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:12, 10.15s/it] 10%|█         | 2/20 [00:16<02:24,  8.05s/it] 15%|█▌        | 3/20 [00:43<04:42, 16.64s/it] 20%|██        | 4/20 [00:58<04:13, 15.83s/it] 25%|██▌       | 5/20 [01:15<04:04, 16.32s/it] 30%|███       | 6/20 [01:20<02:54, 12.47s/it] 35%|███▌      | 7/20 [01:29<02:28, 11.39s/it] 40%|████      | 8/20 [01:37<02:02, 10.20s/it] 45%|████▌     | 9/20 [01:46<01:49,  9.99s/it] 50%|█████     | 10/20 [01:57<01:42, 10.20s/it] 55%|█████▌    | 11/20 [02:17<01:59, 13.31s/it] 60%|██████    | 12/20 [02:31<01:48, 13.55s/it] 65%|██████▌   | 13/20 [02:39<01:22, 11.81s/it] 70%|███████   | 14/20 [02:47<01:03, 10.63s/it] 75%|███████▌  | 15/20 [02:53<00:46,  9.21s/it] 80%|████████  | 16/20 [03:00<00:34,  8.57s/it] 85%|████████▌ | 17/20 [03:07<00:24,  8.11s/it] 90%|█████████ | 18/20 [03:15<00:16,  8.04s/it] 95%|█████████▌| 19/20 [03:25<00:08,  8.53s/it]100%|██████████| 20/20 [03:37<00:00,  9.57s/it]100%|██████████| 20/20 [03:37<00:00, 10.86s/it]
total: F1 0.8786636163614789, Dice:0.896351084729778, Haus:53.864262497626484
testA: F1 0.9148918956381689, Dice:0.9176101833126482, Haus:35.51509962966858
testB: F1 0.7699787785314102, Dice:0.8325737889811654, Haus:108.9117511015002
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1199.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_699.pt
best value: {'total_F1': 0.8968436999955998, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.77803933843542, 'testA_F1': 0.9316684066526738, 'testA_Dice': 0.9211579811266724, 'testA_Haus': 33.845239963563664, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [1250/2000] Lr:0.002037 Total Loss:0.6828, Iter time:10.7593s Data loading time:10.0077s
Training Iter: [1300/2000] Lr:0.001939 Total Loss:0.7340, Iter time:0.4235s Data loading time:0.0001s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:58, 12.53s/it] 10%|█         | 2/20 [00:20<03:01, 10.07s/it] 15%|█▌        | 3/20 [00:48<05:08, 18.16s/it] 20%|██        | 4/20 [01:09<05:07, 19.22s/it] 25%|██▌       | 5/20 [01:31<05:05, 20.36s/it] 30%|███       | 6/20 [01:38<03:39, 15.67s/it] 35%|███▌      | 7/20 [01:51<03:13, 14.87s/it] 40%|████      | 8/20 [02:05<02:55, 14.63s/it] 45%|████▌     | 9/20 [02:13<02:16, 12.43s/it] 50%|█████     | 10/20 [02:22<01:54, 11.46s/it] 55%|█████▌    | 11/20 [02:40<02:00, 13.35s/it] 60%|██████    | 12/20 [02:54<01:48, 13.53s/it] 65%|██████▌   | 13/20 [03:02<01:22, 11.79s/it] 70%|███████   | 14/20 [03:10<01:04, 10.82s/it] 75%|███████▌  | 15/20 [03:16<00:47,  9.42s/it] 80%|████████  | 16/20 [03:25<00:36,  9.14s/it] 85%|████████▌ | 17/20 [03:32<00:25,  8.50s/it] 90%|█████████ | 18/20 [03:39<00:16,  8.26s/it] 95%|█████████▌| 19/20 [03:50<00:08,  8.87s/it]100%|██████████| 20/20 [04:02<00:00,  9.89s/it]100%|██████████| 20/20 [04:02<00:00, 12.13s/it]
total: F1 0.8867238750531046, Dice:0.8940092933050359, Haus:55.93632090409072
testA: F1 0.9173699709975407, Dice:0.914512666954263, Haus:37.537000403640924
testB: F1 0.7947855872197978, Dice:0.8324991723573545, Haus:111.1342824054401
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1299.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_799.pt
best value: {'total_F1': 0.8968436999955998, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.77803933843542, 'testA_F1': 0.9316684066526738, 'testA_Dice': 0.9211579811266724, 'testA_Haus': 33.845239963563664, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [1350/2000] Lr:0.001839 Total Loss:0.6430, Iter time:0.7579s Data loading time:0.0001s
Training Iter: [1400/2000] Lr:0.001739 Total Loss:0.5301, Iter time:0.6927s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:13<04:09, 13.11s/it] 10%|█         | 2/20 [00:20<02:51,  9.51s/it] 15%|█▌        | 3/20 [00:48<05:11, 18.31s/it] 20%|██        | 4/20 [01:14<05:39, 21.25s/it] 25%|██▌       | 5/20 [01:38<05:30, 22.01s/it] 30%|███       | 6/20 [01:43<03:50, 16.50s/it] 35%|███▌      | 7/20 [02:02<03:44, 17.23s/it] 40%|████      | 8/20 [02:16<03:13, 16.13s/it] 45%|████▌     | 9/20 [02:24<02:30, 13.66s/it] 50%|█████     | 10/20 [02:35<02:07, 12.80s/it] 55%|█████▌    | 11/20 [02:53<02:09, 14.43s/it] 60%|██████    | 12/20 [03:07<01:53, 14.18s/it] 65%|██████▌   | 13/20 [03:15<01:27, 12.53s/it] 70%|███████   | 14/20 [03:24<01:08, 11.50s/it] 75%|███████▌  | 15/20 [03:30<00:49,  9.84s/it] 80%|████████  | 16/20 [03:39<00:37,  9.46s/it] 85%|████████▌ | 17/20 [03:47<00:26,  8.90s/it] 90%|█████████ | 18/20 [03:54<00:16,  8.43s/it] 95%|█████████▌| 19/20 [04:03<00:08,  8.67s/it]100%|██████████| 20/20 [04:19<00:00, 10.81s/it]100%|██████████| 20/20 [04:19<00:00, 12.98s/it]
total: F1 0.8818754917475072, Dice:0.8918597721676426, Haus:58.152532115953036
testA: F1 0.9140006980186489, Dice:0.9159774070445554, Haus:35.17833755922353
testB: F1 0.7854998729340835, Dice:0.8195068675369033, Haus:127.07511578614151
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1399.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_899.pt
best value: {'total_F1': 0.8968436999955998, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.77803933843542, 'testA_F1': 0.9316684066526738, 'testA_Dice': 0.9211579811266724, 'testA_Haus': 33.845239963563664, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [1450/2000] Lr:0.001638 Total Loss:0.6321, Iter time:0.6295s Data loading time:0.0001s
Training Iter: [1500/2000] Lr:0.001537 Total Loss:0.6842, Iter time:0.8791s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:50, 12.15s/it] 10%|█         | 2/20 [00:20<02:58,  9.89s/it] 15%|█▌        | 3/20 [00:55<06:05, 21.52s/it] 20%|██        | 4/20 [01:20<06:07, 22.96s/it] 25%|██▌       | 5/20 [01:38<05:12, 20.82s/it] 30%|███       | 6/20 [01:43<03:37, 15.57s/it] 35%|███▌      | 7/20 [01:59<03:26, 15.88s/it] 40%|████      | 8/20 [02:12<02:56, 14.72s/it] 45%|████▌     | 9/20 [02:20<02:20, 12.74s/it] 50%|█████     | 10/20 [02:30<01:57, 11.76s/it] 55%|█████▌    | 11/20 [02:49<02:06, 14.09s/it] 60%|██████    | 12/20 [03:03<01:51, 13.96s/it] 65%|██████▌   | 13/20 [03:10<01:24, 12.03s/it] 70%|███████   | 14/20 [03:19<01:06, 11.14s/it] 75%|███████▌  | 15/20 [03:26<00:48,  9.79s/it] 80%|████████  | 16/20 [03:33<00:36,  9.05s/it] 85%|████████▌ | 17/20 [03:41<00:25,  8.52s/it] 90%|█████████ | 18/20 [03:48<00:16,  8.11s/it] 95%|█████████▌| 19/20 [03:57<00:08,  8.48s/it]100%|██████████| 20/20 [04:10<00:00,  9.73s/it]100%|██████████| 20/20 [04:10<00:00, 12.51s/it]
total: F1 0.8906197114517225, Dice:0.896906761602119, Haus:54.31490250247598
testA: F1 0.9206642663053484, Dice:0.9188648694888992, Haus:33.48791178184275
testB: F1 0.8004860468908456, Dice:0.8310324379417795, Haus:116.79587466437576
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1499.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_999.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Haus_33.4879_iter_1499.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Haus_33.8452_iter_899.pt
best value: {'total_F1': 0.8968436999955998, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.77803933843542, 'testA_F1': 0.9316684066526738, 'testA_Dice': 0.9211579811266724, 'testA_Haus': 33.48791178184275, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [1550/2000] Lr:0.001434 Total Loss:0.8266, Iter time:1.0956s Data loading time:0.0001s
Training Iter: [1600/2000] Lr:0.001330 Total Loss:0.7598, Iter time:0.8948s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:16, 10.37s/it] 10%|█         | 2/20 [00:18<02:43,  9.10s/it] 15%|█▌        | 3/20 [00:45<04:56, 17.42s/it] 20%|██        | 4/20 [01:12<05:34, 20.88s/it] 25%|██▌       | 5/20 [01:31<05:03, 20.22s/it] 30%|███       | 6/20 [01:37<03:36, 15.45s/it] 35%|███▌      | 7/20 [01:54<03:26, 15.90s/it] 40%|████      | 8/20 [02:02<02:42, 13.56s/it] 45%|████▌     | 9/20 [02:10<02:11, 11.91s/it] 50%|█████     | 10/20 [02:21<01:53, 11.39s/it] 55%|█████▌    | 11/20 [02:39<02:01, 13.52s/it] 60%|██████    | 12/20 [02:53<01:50, 13.77s/it] 65%|██████▌   | 13/20 [03:01<01:22, 11.81s/it] 70%|███████   | 14/20 [03:09<01:03, 10.62s/it] 75%|███████▌  | 15/20 [03:15<00:46,  9.36s/it] 80%|████████  | 16/20 [03:23<00:35,  8.93s/it] 85%|████████▌ | 17/20 [03:30<00:25,  8.40s/it] 90%|█████████ | 18/20 [03:38<00:16,  8.20s/it] 95%|█████████▌| 19/20 [03:49<00:08,  8.95s/it]100%|██████████| 20/20 [04:01<00:00, 10.06s/it]100%|██████████| 20/20 [04:01<00:00, 12.08s/it]
total: F1 0.8892255474217086, Dice:0.8961580626278376, Haus:53.995625728723
testA: F1 0.9208047704313861, Dice:0.91773365184608, Haus:34.860413398297275
testB: F1 0.7944878783926772, Dice:0.8314312949731109, Haus:111.40126272000029
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1599.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1099.pt
best value: {'total_F1': 0.8968436999955998, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.77803933843542, 'testA_F1': 0.9316684066526738, 'testA_Dice': 0.9211579811266724, 'testA_Haus': 33.48791178184275, 'testB_F1': 0.8028772689299005, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [1650/2000] Lr:0.001225 Total Loss:0.5871, Iter time:1.5286s Data loading time:0.8576s
Training Iter: [1700/2000] Lr:0.001118 Total Loss:0.6734, Iter time:0.4359s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:43, 11.77s/it] 10%|█         | 2/20 [00:20<03:03, 10.21s/it] 15%|█▌        | 3/20 [00:48<05:11, 18.35s/it] 20%|██        | 4/20 [01:12<05:28, 20.52s/it] 25%|██▌       | 5/20 [01:31<04:55, 19.73s/it] 30%|███       | 6/20 [01:36<03:30, 15.03s/it] 35%|███▌      | 7/20 [01:52<03:19, 15.32s/it] 40%|████      | 8/20 [02:06<02:56, 14.74s/it] 45%|████▌     | 9/20 [02:14<02:20, 12.74s/it] 50%|█████     | 10/20 [02:24<01:57, 11.78s/it] 55%|█████▌    | 11/20 [02:43<02:05, 14.00s/it] 60%|██████    | 12/20 [02:56<01:48, 13.62s/it] 65%|██████▌   | 13/20 [03:03<01:22, 11.77s/it] 70%|███████   | 14/20 [03:12<01:04, 10.80s/it] 75%|███████▌  | 15/20 [03:19<00:48,  9.70s/it] 80%|████████  | 16/20 [03:27<00:36,  9.10s/it] 85%|████████▌ | 17/20 [03:34<00:25,  8.53s/it] 90%|█████████ | 18/20 [03:42<00:16,  8.38s/it] 95%|█████████▌| 19/20 [03:52<00:08,  8.80s/it]100%|██████████| 20/20 [04:05<00:00, 10.19s/it]100%|██████████| 20/20 [04:05<00:00, 12.28s/it]
total: F1 0.8918910810906379, Dice:0.8964975084654945, Haus:52.536785988951564
testA: F1 0.9213062823442885, Dice:0.9187843772014392, Haus:33.56987807519696
testB: F1 0.8036454773296879, Dice:0.8296369022576602, Haus:109.43750973021542
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1699.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1199.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Haus_52.5368_iter_1699.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Haus_52.7780_iter_1099.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_F1_0.8036_iter_1699.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testB_F1_0.8029_iter_299.pt
best value: {'total_F1': 0.8968436999955998, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.536785988951564, 'testA_F1': 0.9316684066526738, 'testA_Dice': 0.9211579811266724, 'testA_Haus': 33.48791178184275, 'testB_F1': 0.8036454773296879, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [1750/2000] Lr:0.001009 Total Loss:0.6727, Iter time:0.8825s Data loading time:0.0002s
Training Iter: [1800/2000] Lr:0.000898 Total Loss:0.6504, Iter time:0.6603s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:48, 12.02s/it] 10%|█         | 2/20 [00:20<03:00, 10.05s/it] 15%|█▌        | 3/20 [00:49<05:15, 18.54s/it] 20%|██        | 4/20 [01:09<05:07, 19.22s/it] 25%|██▌       | 5/20 [01:26<04:38, 18.54s/it] 30%|███       | 6/20 [01:32<03:18, 14.20s/it] 35%|███▌      | 7/20 [01:49<03:14, 14.93s/it] 40%|████      | 8/20 [02:01<02:49, 14.09s/it] 45%|████▌     | 9/20 [02:08<02:12, 12.02s/it] 50%|█████     | 10/20 [02:17<01:50, 11.09s/it] 55%|█████▌    | 11/20 [02:34<01:54, 12.78s/it] 60%|██████    | 12/20 [02:47<01:42, 12.86s/it] 65%|██████▌   | 13/20 [02:55<01:19, 11.32s/it] 70%|███████   | 14/20 [03:03<01:02, 10.34s/it] 75%|███████▌  | 15/20 [03:08<00:44,  8.89s/it] 80%|████████  | 16/20 [03:16<00:34,  8.52s/it] 85%|████████▌ | 17/20 [03:24<00:25,  8.33s/it] 90%|█████████ | 18/20 [03:31<00:16,  8.06s/it] 95%|█████████▌| 19/20 [03:41<00:08,  8.50s/it]100%|██████████| 20/20 [03:58<00:00, 11.00s/it]100%|██████████| 20/20 [03:58<00:00, 11.91s/it]
total: F1 0.8906871235855031, Dice:0.8984426641935708, Haus:52.06878376498668
testA: F1 0.9239558086020491, Dice:0.9193520244790373, Haus:32.99759842865022
testB: F1 0.7908810685358674, Dice:0.8357145833371717, Haus:109.28233977399611
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1799.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1299.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Haus_52.0688_iter_1799.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_total_Haus_52.5368_iter_1699.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Haus_32.9976_iter_1799.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/best_testA_Haus_33.4879_iter_1499.pt
best value: {'total_F1': 0.8968436999955998, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.06878376498668, 'testA_F1': 0.9316684066526738, 'testA_Dice': 0.9211579811266724, 'testA_Haus': 32.99759842865022, 'testB_F1': 0.8036454773296879, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [1850/2000] Lr:0.000785 Total Loss:0.6391, Iter time:0.5700s Data loading time:0.0001s
Training Iter: [1900/2000] Lr:0.000667 Total Loss:0.7926, Iter time:0.6206s Data loading time:0.0001s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:13, 10.21s/it] 10%|█         | 2/20 [00:19<02:49,  9.44s/it] 15%|█▌        | 3/20 [00:47<05:09, 18.21s/it] 20%|██        | 4/20 [01:13<05:40, 21.29s/it] 25%|██▌       | 5/20 [01:32<05:04, 20.32s/it] 30%|███       | 6/20 [01:38<03:37, 15.53s/it] 35%|███▌      | 7/20 [01:53<03:19, 15.37s/it] 40%|████      | 8/20 [02:06<02:55, 14.62s/it] 45%|████▌     | 9/20 [02:14<02:17, 12.53s/it] 50%|█████     | 10/20 [02:23<01:53, 11.33s/it] 55%|█████▌    | 11/20 [02:41<02:01, 13.46s/it] 60%|██████    | 12/20 [02:56<01:50, 13.81s/it] 65%|██████▌   | 13/20 [03:03<01:23, 11.90s/it] 70%|███████   | 14/20 [03:12<01:06, 11.01s/it] 75%|███████▌  | 15/20 [03:18<00:47,  9.50s/it] 80%|████████  | 16/20 [03:26<00:35,  8.95s/it] 85%|████████▌ | 17/20 [03:34<00:25,  8.66s/it] 90%|█████████ | 18/20 [03:41<00:16,  8.18s/it] 95%|█████████▌| 19/20 [03:50<00:08,  8.49s/it]100%|██████████| 20/20 [04:03<00:00,  9.90s/it]100%|██████████| 20/20 [04:03<00:00, 12.18s/it]
total: F1 0.8866313784221118, Dice:0.896829658333021, Haus:53.21369716629672
testA: F1 0.9193436029296486, Dice:0.917074614163665, Haus:34.460564243112024
testB: F1 0.7884947048995038, Dice:0.8360947908410903, Haus:109.47309593585078
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1899.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1399.pt
best value: {'total_F1': 0.8968436999955998, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.06878376498668, 'testA_F1': 0.9316684066526738, 'testA_Dice': 0.9211579811266724, 'testA_Haus': 32.99759842865022, 'testB_F1': 0.8036454773296879, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
Training Iter: [1950/2000] Lr:0.000543 Total Loss:0.7260, Iter time:0.5673s Data loading time:0.0003s
Training Iter: [2000/2000] Lr:0.000400 Total Loss:0.5443, Iter time:0.4886s Data loading time:0.0001s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:50, 12.12s/it] 10%|█         | 2/20 [00:21<03:05, 10.28s/it] 15%|█▌        | 3/20 [00:49<05:16, 18.60s/it] 20%|██        | 4/20 [01:17<05:54, 22.18s/it] 25%|██▌       | 5/20 [01:34<05:07, 20.49s/it] 30%|███       | 6/20 [01:41<03:40, 15.73s/it] 35%|███▌      | 7/20 [01:57<03:26, 15.91s/it] 40%|████      | 8/20 [02:09<02:54, 14.52s/it] 45%|████▌     | 9/20 [02:17<02:19, 12.70s/it] 50%|█████     | 10/20 [02:27<01:57, 11.71s/it] 55%|█████▌    | 11/20 [02:46<02:06, 14.01s/it] 60%|██████    | 12/20 [02:59<01:50, 13.76s/it] 65%|██████▌   | 13/20 [03:08<01:24, 12.14s/it] 70%|███████   | 14/20 [03:17<01:07, 11.25s/it] 75%|███████▌  | 15/20 [03:22<00:47,  9.56s/it] 80%|████████  | 16/20 [03:30<00:35,  8.99s/it] 85%|████████▌ | 17/20 [03:39<00:26,  8.82s/it] 90%|█████████ | 18/20 [03:46<00:16,  8.37s/it] 95%|█████████▌| 19/20 [03:56<00:09,  9.05s/it]100%|██████████| 20/20 [04:09<00:00, 10.12s/it]100%|██████████| 20/20 [04:09<00:00, 12.48s/it]
total: F1 0.8860079135888947, Dice:0.8953006475839222, Haus:52.99180314390014
testA: F1 0.9180072659803085, Dice:0.915055979914045, Haus:34.90293401201079
testB: F1 0.7900098564146553, Dice:0.836034650593553, Haus:107.25841053956806
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1999.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_21h_51m_37s/iter_1499.pt
best value: {'total_F1': 0.8968436999955998, 'total_Dice': 0.8984534973554963, 'total_Haus': 52.06878376498668, 'testA_F1': 0.9316684066526738, 'testA_Dice': 0.9211579811266724, 'testA_Haus': 32.99759842865022, 'testB_F1': 0.8036454773296879, 'testB_Dice': 0.8396526483402054, 'testB_Haus': 105.42924878364087}
