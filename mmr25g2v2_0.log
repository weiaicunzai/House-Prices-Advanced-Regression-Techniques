nohup: 忽略输入
/home/baiyu/miniconda3/bin/conda
/home/baiyu/miniconda3/envs/torch1.13/lib/python3.10/site-packages/numpy/__init__.py
ok
args:  Namespace(b=8, lr=0.004, e=120, iter=2000, eval_iter=100, wd=0.0001, resume=False, net='tgt', dataset='Glas', prefix='unet_branch_SGD_473', alpha=0.1, op='or', download=True, gpu=True, baseline=False, pretrain=False, poly=True, min_lr=0.0004, branch='hybird', fp16=True, wait=False, vis=False, imgset='train', rate=25)
saving tensorboard log into /home/xuxinan/mmCode2/runs/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s
img_set train
Glas : data_folder: /data/hdd1/by/House-Prices-Advanced-Regression-Techniques/data/Warwick QU Dataset (Released 2016_07_08)
search_path: /data/hdd1/by/House-Prices-Advanced-Regression-Techniques/data/Warwick QU Dataset (Released 2016_07_08)/**/*.bmp
Glas:label_re train_[0-9]+_anno\.bmp

train
Glas : data_folder: /data/hdd1/by/House-Prices-Advanced-Regression-Techniques/data/Warwick QU Dataset (Released 2016_07_08)
search_path: /data/hdd1/by/House-Prices-Advanced-Regression-Techniques/data/Warwick QU Dataset (Released 2016_07_08)/**/*.bmp
Glas:label_re val_[0-9]+_anno\.bmp

val

TG(
  (backbone): ResNet(
    (conv1): Sequential(
      (0): Conv2d(3, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
      (3): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (5): ReLU(inplace=True)
      (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (act1): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (1): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
        (downsample): Sequential(
          (0): AvgPool2d(kernel_size=2, stride=2, padding=0)
          (1): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (3): BasicBlock(
        (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Identity()
          (1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (3): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (4): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (5): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Identity()
          (1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2), dilation=(2, 2), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(4, 4), dilation=(4, 4), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (drop_block): Identity()
        (act1): ReLU(inplace=True)
        (aa): Identity()
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ReLU(inplace=True)
      )
    )
    (global_pool): Identity()
    (fc): Identity()
  )
  (project): Sequential(
    (0): Conv2d(64, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (1): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (classifier): Sequential(
    (0): Conv2d(112, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 2, kernel_size=(1, 1), stride=(1, 1))
  )
  (fcs): ModuleList(
    (0): BasicLinear(
      (fc): Sequential(
        (0): Linear(in_features=64, out_features=64, bias=True)
      )
    )
    (1): BasicLinear(
      (fc): Sequential(
        (0): Linear(in_features=128, out_features=64, bias=True)
      )
    )
    (2): BasicLinear(
      (fc): Sequential(
        (0): Linear(in_features=256, out_features=64, bias=True)
      )
    )
    (3): BasicLinear(
      (fc): Sequential(
        (0): Linear(in_features=512, out_features=64, bias=True)
      )
    )
  )
  (gland_head_project): Sequential(
    (0): BasicConv2d(
      (conv): Sequential(
        (0): Conv2d(512, 64, kernel_size=(1, 1), stride=(1, 1))
        (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
      )
    )
  )
  (aux_head): Sequential(
    (0): BasicConv2d(
      (conv): Sequential(
        (0): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1))
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
      )
    )
    (1): BasicConv2d(
      (conv): Sequential(
        (0): Conv2d(128, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): BatchNorm2d(2, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
      )
    )
  )
)

train:ckpt_path: /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s
GlandContrastLoss 4
rate:25
/home/baiyu/miniconda3/envs/torch1.13/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:138: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Training Iter: [50/2000] Lr:0.001000 Total Loss:0.7473, Iter time:0.8007s Data loading time:0.0002s
/home/xuxinan/mmCode2/losses/loss.py:324: RuntimeWarning: invalid value encountered in divide
  w = w / w.max()
Training Iter: [100/2000] Lr:0.002000 Total Loss:0.6240, Iter time:0.5069s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:44, 11.79s/it] 10%|█         | 2/20 [00:19<02:52,  9.59s/it]/home/baiyu/miniconda3/envs/torch1.13/lib/python3.10/site-packages/skimage/_shared/utils.py:157: UserWarning: Only one label was provided to `remove_small_objects`. Did you mean to use a boolean array?
  return func(*args, **kwargs)
 15%|█▌        | 3/20 [00:55<06:08, 21.66s/it] 20%|██        | 4/20 [01:19<05:57, 22.35s/it] 25%|██▌       | 5/20 [01:37<05:14, 21.00s/it] 30%|███       | 6/20 [01:43<03:43, 15.93s/it] 35%|███▌      | 7/20 [01:59<03:25, 15.77s/it] 40%|████      | 8/20 [02:12<02:59, 14.92s/it] 45%|████▌     | 9/20 [02:19<02:18, 12.56s/it] 50%|█████     | 10/20 [02:29<01:57, 11.76s/it] 55%|█████▌    | 11/20 [02:48<02:05, 13.89s/it] 60%|██████    | 12/20 [03:01<01:49, 13.68s/it] 65%|██████▌   | 13/20 [03:09<01:23, 11.88s/it] 70%|███████   | 14/20 [03:17<01:04, 10.82s/it] 75%|███████▌  | 15/20 [03:24<00:47,  9.41s/it] 80%|████████  | 16/20 [03:31<00:35,  8.79s/it] 85%|████████▌ | 17/20 [03:38<00:24,  8.26s/it] 90%|█████████ | 18/20 [03:44<00:15,  7.70s/it] 95%|█████████▌| 19/20 [03:53<00:08,  8.00s/it]100%|██████████| 20/20 [04:04<00:00,  8.78s/it]100%|██████████| 20/20 [04:04<00:00, 12.20s/it]
total: F1 0.8820625289100057, Dice:0.8968857712327335, Haus:53.51098021699546
testA: F1 0.9155583858867558, Dice:0.9181657304669429, Haus:34.10161511690486
testB: F1 0.7815749579797568, Dice:0.8330458935301037, Haus:111.7390755172672
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_F1_0.8821_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_Dice_0.8969_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_Haus_53.5110_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testA_F1_0.9156_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testA_Dice_0.9182_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testA_Haus_34.1016_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_F1_0.7816_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Dice_0.8330_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Haus_111.7391_iter_99.pt
best value: {'total_F1': 0.8820625289100057, 'total_Dice': 0.8968857712327335, 'total_Haus': 53.51098021699546, 'testA_F1': 0.9155583858867558, 'testA_Dice': 0.9181657304669429, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7815749579797568, 'testB_Dice': 0.8330458935301037, 'testB_Haus': 111.7390755172672}
/home/xuxinan/mmCode2/losses/loss.py:265: RuntimeWarning: invalid value encountered in divide
  w = w / w.max()
Training Iter: [150/2000] Lr:0.003000 Total Loss:0.6257, Iter time:3.9302s Data loading time:3.5510s
Training Iter: [200/2000] Lr:0.004000 Total Loss:0.8040, Iter time:0.7647s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<03:02,  9.60s/it] 10%|█         | 2/20 [00:18<02:44,  9.12s/it] 15%|█▌        | 3/20 [01:03<07:14, 25.58s/it] 20%|██        | 4/20 [01:19<05:46, 21.63s/it] 25%|██▌       | 5/20 [01:35<04:53, 19.59s/it] 30%|███       | 6/20 [01:40<03:24, 14.63s/it] 35%|███▌      | 7/20 [01:53<03:05, 14.24s/it] 40%|████      | 8/20 [02:30<04:18, 21.53s/it] 45%|████▌     | 9/20 [02:38<03:08, 17.14s/it] 50%|█████     | 10/20 [02:46<02:23, 14.35s/it] 55%|█████▌    | 11/20 [02:55<01:55, 12.84s/it] 60%|██████    | 12/20 [03:13<01:55, 14.48s/it] 65%|██████▌   | 13/20 [03:22<01:28, 12.64s/it] 70%|███████   | 14/20 [03:33<01:12, 12.14s/it] 75%|███████▌  | 15/20 [03:38<00:50, 10.04s/it] 80%|████████  | 16/20 [03:57<00:51, 12.76s/it] 85%|████████▌ | 17/20 [04:19<00:46, 15.61s/it] 90%|█████████ | 18/20 [04:26<00:25, 12.98s/it] 95%|█████████▌| 19/20 [04:38<00:12, 12.57s/it]100%|██████████| 20/20 [04:51<00:00, 12.89s/it]100%|██████████| 20/20 [04:51<00:00, 14.60s/it]
total: F1 0.8516177568047695, Dice:0.8729808124636491, Haus:62.011192047457186
testA: F1 0.8797305150017957, Dice:0.8881024741116996, Haus:44.183668692086584
testB: F1 0.7672794822136928, Dice:0.8276158275194957, Haus:115.49376211356898
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_199.pt
best value: {'total_F1': 0.8820625289100057, 'total_Dice': 0.8968857712327335, 'total_Haus': 53.51098021699546, 'testA_F1': 0.9155583858867558, 'testA_Dice': 0.9181657304669429, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7815749579797568, 'testB_Dice': 0.8330458935301037, 'testB_Haus': 111.7390755172672}
Training Iter: [250/2000] Lr:0.003910 Total Loss:0.8418, Iter time:0.6646s Data loading time:0.0002s
Training Iter: [300/2000] Lr:0.003819 Total Loss:0.8108, Iter time:0.4533s Data loading time:0.0003s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<03:07,  9.84s/it] 10%|█         | 2/20 [00:16<02:23,  7.97s/it] 15%|█▌        | 3/20 [00:32<03:20, 11.78s/it] 20%|██        | 4/20 [00:47<03:26, 12.91s/it] 25%|██▌       | 5/20 [01:11<04:13, 16.87s/it] 30%|███       | 6/20 [01:15<02:56, 12.61s/it] 35%|███▌      | 7/20 [01:28<02:46, 12.80s/it] 40%|████      | 8/20 [01:41<02:32, 12.74s/it] 45%|████▌     | 9/20 [01:48<02:01, 11.07s/it] 50%|█████     | 10/20 [01:57<01:43, 10.33s/it] 55%|█████▌    | 11/20 [02:12<01:45, 11.70s/it] 60%|██████    | 12/20 [02:29<01:45, 13.25s/it] 65%|██████▌   | 13/20 [02:35<01:17, 11.03s/it] 70%|███████   | 14/20 [02:42<00:59,  9.95s/it] 75%|███████▌  | 15/20 [02:47<00:42,  8.55s/it] 80%|████████  | 16/20 [02:58<00:36,  9.23s/it] 85%|████████▌ | 17/20 [03:07<00:27,  9.10s/it] 90%|█████████ | 18/20 [03:15<00:17,  8.83s/it] 95%|█████████▌| 19/20 [03:24<00:08,  8.97s/it]100%|██████████| 20/20 [03:36<00:00,  9.89s/it]100%|██████████| 20/20 [03:36<00:00, 10.85s/it]
total: F1 0.8788096396232172, Dice:0.8911899761687719, Haus:54.305073783628416
testA: F1 0.9128612268110644, Dice:0.9099294499794842, Haus:35.401175263619834
testB: F1 0.7766548780596769, Dice:0.8349715547366336, Haus:111.01676934365426
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_299.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Dice_0.8350_iter_299.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Dice_0.8330_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Haus_111.0168_iter_299.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Haus_111.7391_iter_99.pt
best value: {'total_F1': 0.8820625289100057, 'total_Dice': 0.8968857712327335, 'total_Haus': 53.51098021699546, 'testA_F1': 0.9155583858867558, 'testA_Dice': 0.9181657304669429, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7815749579797568, 'testB_Dice': 0.8349715547366336, 'testB_Haus': 111.01676934365426}
Training Iter: [350/2000] Lr:0.003729 Total Loss:0.6835, Iter time:0.4402s Data loading time:0.0034s
Training Iter: [400/2000] Lr:0.003638 Total Loss:0.8332, Iter time:5.5467s Data loading time:4.6124s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:08<02:50,  8.99s/it] 10%|█         | 2/20 [00:15<02:20,  7.82s/it] 15%|█▌        | 3/20 [00:38<04:04, 14.37s/it] 20%|██        | 4/20 [01:03<05:01, 18.81s/it] 25%|██▌       | 5/20 [01:21<04:35, 18.37s/it] 30%|███       | 6/20 [01:27<03:17, 14.11s/it] 35%|███▌      | 7/20 [01:44<03:16, 15.15s/it] 40%|████      | 8/20 [01:57<02:53, 14.45s/it] 45%|████▌     | 9/20 [02:04<02:14, 12.20s/it] 50%|█████     | 10/20 [02:16<01:59, 11.97s/it] 55%|█████▌    | 11/20 [02:33<02:01, 13.49s/it] 60%|██████    | 12/20 [02:49<01:53, 14.24s/it] 65%|██████▌   | 13/20 [02:55<01:24, 12.02s/it] 70%|███████   | 14/20 [03:03<01:03, 10.62s/it] 75%|███████▌  | 15/20 [03:08<00:45,  9.04s/it] 80%|████████  | 16/20 [03:15<00:33,  8.49s/it] 85%|████████▌ | 17/20 [03:24<00:25,  8.37s/it] 90%|█████████ | 18/20 [03:31<00:15,  7.97s/it] 95%|█████████▌| 19/20 [03:39<00:08,  8.20s/it]100%|██████████| 20/20 [03:51<00:00,  9.32s/it]100%|██████████| 20/20 [03:51<00:00, 11.59s/it]
total: F1 0.8795871191669505, Dice:0.892520921872263, Haus:53.58719064545503
testA: F1 0.9146073419121847, Dice:0.9115811015453649, Haus:36.192017743806964
testB: F1 0.7745264509312498, Dice:0.8353403828529575, Haus:105.77270935039925
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_399.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Dice_0.8353_iter_399.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Dice_0.8350_iter_299.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Haus_105.7727_iter_399.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Haus_111.0168_iter_299.pt
best value: {'total_F1': 0.8820625289100057, 'total_Dice': 0.8968857712327335, 'total_Haus': 53.51098021699546, 'testA_F1': 0.9155583858867558, 'testA_Dice': 0.9181657304669429, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7815749579797568, 'testB_Dice': 0.8353403828529575, 'testB_Haus': 105.77270935039925}
Training Iter: [450/2000] Lr:0.003547 Total Loss:0.9441, Iter time:7.9664s Data loading time:7.0741s
Training Iter: [500/2000] Lr:0.003455 Total Loss:0.8626, Iter time:0.6292s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:11, 10.09s/it] 10%|█         | 2/20 [00:16<02:22,  7.94s/it] 15%|█▌        | 3/20 [00:30<03:02, 10.72s/it] 20%|██        | 4/20 [00:49<03:40, 13.80s/it] 25%|██▌       | 5/20 [01:06<03:45, 15.03s/it] 30%|███       | 6/20 [01:12<02:46, 11.90s/it] 35%|███▌      | 7/20 [01:24<02:38, 12.22s/it] 40%|████      | 8/20 [01:38<02:31, 12.61s/it] 45%|████▌     | 9/20 [01:45<01:59, 10.89s/it] 50%|█████     | 10/20 [01:54<01:43, 10.40s/it] 55%|█████▌    | 11/20 [02:13<01:56, 13.00s/it] 60%|██████    | 12/20 [02:25<01:41, 12.75s/it] 65%|██████▌   | 13/20 [02:33<01:17, 11.05s/it] 70%|███████   | 14/20 [02:41<01:01, 10.26s/it] 75%|███████▌  | 15/20 [02:46<00:43,  8.74s/it] 80%|████████  | 16/20 [02:55<00:34,  8.61s/it] 85%|████████▌ | 17/20 [03:03<00:25,  8.65s/it] 90%|█████████ | 18/20 [03:10<00:16,  8.03s/it] 95%|█████████▌| 19/20 [03:17<00:07,  7.89s/it]100%|██████████| 20/20 [03:29<00:00,  8.85s/it]100%|██████████| 20/20 [03:29<00:00, 10.45s/it]
total: F1 0.8708214774220565, Dice:0.8906469487895997, Haus:56.617244709776
testA: F1 0.9033298262456658, Dice:0.9104192783902788, Haus:38.57753033910171
testB: F1 0.7732964309512298, Dice:0.8313299599875614, Haus:110.73638782179898
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_499.pt
best value: {'total_F1': 0.8820625289100057, 'total_Dice': 0.8968857712327335, 'total_Haus': 53.51098021699546, 'testA_F1': 0.9155583858867558, 'testA_Dice': 0.9181657304669429, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7815749579797568, 'testB_Dice': 0.8353403828529575, 'testB_Haus': 105.77270935039925}
Training Iter: [550/2000] Lr:0.003363 Total Loss:0.6600, Iter time:7.6001s Data loading time:7.0639s
Training Iter: [600/2000] Lr:0.003271 Total Loss:0.8835, Iter time:0.8673s Data loading time:0.0003s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:08<02:50,  8.98s/it] 10%|█         | 2/20 [00:16<02:29,  8.28s/it] 15%|█▌        | 3/20 [00:44<04:50, 17.06s/it] 20%|██        | 4/20 [01:08<05:18, 19.94s/it] 25%|██▌       | 5/20 [01:26<04:49, 19.31s/it] 30%|███       | 6/20 [01:32<03:26, 14.73s/it] 35%|███▌      | 7/20 [01:50<03:23, 15.62s/it] 40%|████      | 8/20 [02:04<03:01, 15.14s/it] 45%|████▌     | 9/20 [02:12<02:21, 12.85s/it] 50%|█████     | 10/20 [02:23<02:03, 12.33s/it] 55%|█████▌    | 11/20 [02:39<02:01, 13.54s/it] 60%|██████    | 12/20 [02:53<01:50, 13.81s/it] 65%|██████▌   | 13/20 [03:00<01:20, 11.57s/it] 70%|███████   | 14/20 [03:07<01:00, 10.11s/it] 75%|███████▌  | 15/20 [03:13<00:44,  8.86s/it] 80%|████████  | 16/20 [03:20<00:33,  8.45s/it] 85%|████████▌ | 17/20 [03:28<00:25,  8.43s/it] 90%|█████████ | 18/20 [03:36<00:16,  8.23s/it] 95%|█████████▌| 19/20 [03:46<00:08,  8.61s/it]100%|██████████| 20/20 [03:59<00:00,  9.88s/it]100%|██████████| 20/20 [03:59<00:00, 11.95s/it]
total: F1 0.8885861831095502, Dice:0.897445416169983, Haus:53.23338888577551
testA: F1 0.9247713245744111, Dice:0.9165710747486263, Haus:35.435599894297155
testB: F1 0.7800307587149694, Dice:0.840068440434052, Haus:106.62675586021058
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_599.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_F1_0.8886_iter_599.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_F1_0.8821_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_Dice_0.8974_iter_599.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_Dice_0.8969_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_Haus_53.2334_iter_599.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_Haus_53.5110_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testA_F1_0.9248_iter_599.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testA_F1_0.9156_iter_99.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Dice_0.8401_iter_599.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Dice_0.8353_iter_399.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.897445416169983, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9247713245744111, 'testA_Dice': 0.9181657304669429, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7815749579797568, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [650/2000] Lr:0.003179 Total Loss:0.6678, Iter time:0.3645s Data loading time:0.0002s
Training Iter: [700/2000] Lr:0.003086 Total Loss:0.6562, Iter time:0.5091s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:11, 10.08s/it] 10%|█         | 2/20 [00:17<02:30,  8.35s/it] 15%|█▌        | 3/20 [00:32<03:15, 11.51s/it] 20%|██        | 4/20 [00:47<03:28, 13.05s/it] 25%|██▌       | 5/20 [01:05<03:38, 14.54s/it] 30%|███       | 6/20 [01:10<02:39, 11.43s/it] 35%|███▌      | 7/20 [01:24<02:40, 12.33s/it] 40%|████      | 8/20 [01:35<02:23, 11.98s/it] 45%|████▌     | 9/20 [01:42<01:54, 10.44s/it] 50%|█████     | 10/20 [01:50<01:36,  9.69s/it] 55%|█████▌    | 11/20 [02:04<01:39, 11.03s/it] 60%|██████    | 12/20 [02:11<01:17,  9.66s/it] 65%|██████▌   | 13/20 [02:17<01:00,  8.63s/it] 70%|███████   | 14/20 [02:26<00:51,  8.51s/it] 75%|███████▌  | 15/20 [02:31<00:37,  7.59s/it] 80%|████████  | 16/20 [02:38<00:30,  7.55s/it] 85%|████████▌ | 17/20 [02:45<00:21,  7.12s/it] 90%|█████████ | 18/20 [02:52<00:14,  7.09s/it] 95%|█████████▌| 19/20 [03:00<00:07,  7.48s/it]100%|██████████| 20/20 [03:11<00:00,  8.66s/it]100%|██████████| 20/20 [03:11<00:00,  9.59s/it]
total: F1 0.8725507136773631, Dice:0.8929953228816482, Haus:55.413292372647994
testA: F1 0.9108959979464434, Dice:0.914741773875103, Haus:35.96452488190004
testB: F1 0.757514860870124, Dice:0.8277559699012838, Haus:113.75959484489192
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_699.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_199.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.897445416169983, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9247713245744111, 'testA_Dice': 0.9181657304669429, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7815749579797568, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [750/2000] Lr:0.002993 Total Loss:0.7339, Iter time:0.6484s Data loading time:0.0018s
Training Iter: [800/2000] Lr:0.002899 Total Loss:0.6369, Iter time:2.7326s Data loading time:2.1816s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<02:54,  9.20s/it] 10%|█         | 2/20 [00:15<02:11,  7.32s/it] 15%|█▌        | 3/20 [00:30<03:07, 11.02s/it] 20%|██        | 4/20 [00:44<03:13, 12.11s/it] 25%|██▌       | 5/20 [01:00<03:24, 13.66s/it] 30%|███       | 6/20 [01:06<02:31, 10.86s/it] 35%|███▌      | 7/20 [01:19<02:30, 11.57s/it] 40%|████      | 8/20 [01:29<02:12, 11.07s/it] 45%|████▌     | 9/20 [01:35<01:46,  9.70s/it] 50%|█████     | 10/20 [01:48<01:46, 10.70s/it] 55%|█████▌    | 11/20 [02:05<01:53, 12.58s/it] 60%|██████    | 12/20 [02:15<01:33, 11.69s/it] 65%|██████▌   | 13/20 [02:21<01:10, 10.04s/it] 70%|███████   | 14/20 [02:28<00:54,  9.01s/it] 75%|███████▌  | 15/20 [02:33<00:39,  7.94s/it] 80%|████████  | 16/20 [02:40<00:29,  7.50s/it] 85%|████████▌ | 17/20 [02:49<00:24,  8.05s/it] 90%|█████████ | 18/20 [02:57<00:16,  8.11s/it] 95%|█████████▌| 19/20 [03:04<00:07,  7.73s/it]100%|██████████| 20/20 [03:17<00:00,  9.25s/it]100%|██████████| 20/20 [03:17<00:00,  9.87s/it]
total: F1 0.8663323519077457, Dice:0.8872059193801807, Haus:57.266300242915875
testA: F1 0.8993027837683761, Dice:0.906429499199238, Haus:39.96189721064048
testB: F1 0.767421056325855, Dice:0.8295351799230068, Haus:109.17950933974207
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_799.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_299.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.897445416169983, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9247713245744111, 'testA_Dice': 0.9181657304669429, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7815749579797568, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [850/2000] Lr:0.002805 Total Loss:0.6005, Iter time:3.2859s Data loading time:2.9253s
Training Iter: [900/2000] Lr:0.002711 Total Loss:0.8468, Iter time:0.8156s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<02:51,  9.01s/it] 10%|█         | 2/20 [00:16<02:21,  7.88s/it] 15%|█▌        | 3/20 [00:40<04:18, 15.22s/it] 20%|██        | 4/20 [00:53<03:54, 14.65s/it] 25%|██▌       | 5/20 [01:09<03:46, 15.09s/it] 30%|███       | 6/20 [01:14<02:43, 11.67s/it] 35%|███▌      | 7/20 [01:29<02:44, 12.69s/it] 40%|████      | 8/20 [01:39<02:23, 11.93s/it] 45%|████▌     | 9/20 [01:46<01:52, 10.26s/it] 50%|█████     | 10/20 [01:53<01:34,  9.42s/it] 55%|█████▌    | 11/20 [02:08<01:38, 10.93s/it] 60%|██████    | 12/20 [02:20<01:29, 11.25s/it] 65%|██████▌   | 13/20 [02:25<01:06,  9.55s/it] 70%|███████   | 14/20 [02:32<00:52,  8.72s/it] 75%|███████▌  | 15/20 [02:37<00:37,  7.48s/it] 80%|████████  | 16/20 [02:44<00:29,  7.25s/it] 85%|████████▌ | 17/20 [02:49<00:20,  6.82s/it] 90%|█████████ | 18/20 [02:57<00:13,  6.92s/it] 95%|█████████▌| 19/20 [03:06<00:07,  7.70s/it]100%|██████████| 20/20 [03:19<00:00,  9.29s/it]100%|██████████| 20/20 [03:19<00:00,  9.98s/it]
total: F1 0.8823041815808009, Dice:0.8896715326801197, Haus:57.828405288759846
testA: F1 0.9175495006020216, Dice:0.9154667331856168, Haus:35.33487073746121
testB: F1 0.7765682245171409, Dice:0.8122859311636266, Haus:125.30900894265567
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_899.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_399.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.897445416169983, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9247713245744111, 'testA_Dice': 0.9181657304669429, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7815749579797568, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [950/2000] Lr:0.002616 Total Loss:0.6512, Iter time:3.7433s Data loading time:3.4059s
Training Iter: [1000/2000] Lr:0.002521 Total Loss:0.7434, Iter time:3.3070s Data loading time:2.6622s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:19, 10.51s/it] 10%|█         | 2/20 [00:18<02:38,  8.82s/it] 15%|█▌        | 3/20 [00:51<05:42, 20.13s/it] 20%|██        | 4/20 [01:06<04:46, 17.88s/it] 25%|██▌       | 5/20 [01:28<04:49, 19.31s/it] 30%|███       | 6/20 [01:32<03:20, 14.35s/it] 35%|███▌      | 7/20 [01:45<03:01, 13.97s/it] 40%|████      | 8/20 [01:57<02:38, 13.19s/it] 45%|████▌     | 9/20 [02:04<02:02, 11.12s/it] 50%|█████     | 10/20 [02:12<01:43, 10.33s/it] 55%|█████▌    | 11/20 [02:26<01:43, 11.52s/it] 60%|██████    | 12/20 [02:39<01:35, 11.93s/it] 65%|██████▌   | 13/20 [02:46<01:12, 10.36s/it] 70%|███████   | 14/20 [02:54<00:57,  9.64s/it] 75%|███████▌  | 15/20 [03:00<00:42,  8.55s/it] 80%|████████  | 16/20 [03:07<00:32,  8.12s/it] 85%|████████▌ | 17/20 [03:14<00:23,  7.72s/it] 90%|█████████ | 18/20 [03:23<00:16,  8.03s/it] 95%|█████████▌| 19/20 [03:32<00:08,  8.32s/it]100%|██████████| 20/20 [03:46<00:00, 10.12s/it]100%|██████████| 20/20 [03:46<00:00, 11.32s/it]
total: F1 0.8785194496967875, Dice:0.8864606200374903, Haus:60.15965013743265
testA: F1 0.9110114641963155, Dice:0.9085439244596824, Haus:39.1499911749097
testB: F1 0.781043406198205, Dice:0.8202107067709138, Haus:123.18862702500158
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_999.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_499.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.897445416169983, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9247713245744111, 'testA_Dice': 0.9181657304669429, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7815749579797568, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [1050/2000] Lr:0.002425 Total Loss:0.6455, Iter time:5.1799s Data loading time:4.6235s
Training Iter: [1100/2000] Lr:0.002329 Total Loss:0.6906, Iter time:0.6217s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:07<02:31,  8.00s/it] 10%|█         | 2/20 [00:14<02:11,  7.30s/it] 15%|█▌        | 3/20 [00:40<04:23, 15.51s/it] 20%|██        | 4/20 [00:58<04:24, 16.56s/it] 25%|██▌       | 5/20 [01:16<04:18, 17.25s/it] 30%|███       | 6/20 [01:22<03:04, 13.21s/it] 35%|███▌      | 7/20 [01:35<02:52, 13.26s/it] 40%|████      | 8/20 [01:45<02:26, 12.24s/it] 45%|████▌     | 9/20 [01:52<01:55, 10.52s/it] 50%|█████     | 10/20 [02:01<01:40, 10.08s/it] 55%|█████▌    | 11/20 [02:20<01:54, 12.71s/it] 60%|██████    | 12/20 [02:31<01:38, 12.29s/it] 65%|██████▌   | 13/20 [02:38<01:14, 10.62s/it] 70%|███████   | 14/20 [02:45<00:57,  9.57s/it] 75%|███████▌  | 15/20 [02:50<00:41,  8.37s/it] 80%|████████  | 16/20 [02:57<00:31,  7.92s/it] 85%|████████▌ | 17/20 [03:04<00:22,  7.54s/it] 90%|█████████ | 18/20 [03:10<00:14,  7.18s/it] 95%|█████████▌| 19/20 [03:19<00:07,  7.74s/it]100%|██████████| 20/20 [03:31<00:00,  9.07s/it]100%|██████████| 20/20 [03:31<00:00, 10.60s/it]
total: F1 0.8723269033637809, Dice:0.892059811063659, Haus:57.18585482863656
testA: F1 0.9056575736551448, Dice:0.9136833557066617, Haus:36.345439159694315
testB: F1 0.7723348924896913, Dice:0.8271891771346512, Haus:119.70710183546328
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1099.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_599.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.897445416169983, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9247713245744111, 'testA_Dice': 0.9181657304669429, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7815749579797568, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [1150/2000] Lr:0.002232 Total Loss:0.6790, Iter time:0.7012s Data loading time:0.0001s
Training Iter: [1200/2000] Lr:0.002135 Total Loss:0.7103, Iter time:0.5080s Data loading time:0.0003s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<03:09,  9.95s/it] 10%|█         | 2/20 [00:18<02:43,  9.09s/it] 15%|█▌        | 3/20 [00:41<04:24, 15.57s/it] 20%|██        | 4/20 [00:53<03:46, 14.18s/it] 25%|██▌       | 5/20 [01:11<03:49, 15.30s/it] 30%|███       | 6/20 [01:16<02:47, 11.93s/it] 35%|███▌      | 7/20 [01:30<02:43, 12.58s/it] 40%|████      | 8/20 [01:42<02:30, 12.58s/it] 45%|████▌     | 9/20 [01:50<02:02, 11.15s/it] 50%|█████     | 10/20 [02:04<01:57, 11.78s/it] 55%|█████▌    | 11/20 [02:18<01:52, 12.50s/it] 60%|██████    | 12/20 [02:31<01:42, 12.87s/it] 65%|██████▌   | 13/20 [02:39<01:18, 11.26s/it] 70%|███████   | 14/20 [02:46<01:00, 10.10s/it] 75%|███████▌  | 15/20 [02:52<00:43,  8.67s/it] 80%|████████  | 16/20 [02:58<00:32,  8.02s/it] 85%|████████▌ | 17/20 [03:04<00:22,  7.44s/it] 90%|█████████ | 18/20 [03:11<00:14,  7.12s/it] 95%|█████████▌| 19/20 [03:18<00:07,  7.06s/it]100%|██████████| 20/20 [03:30<00:00,  8.63s/it]100%|██████████| 20/20 [03:30<00:00, 10.53s/it]
total: F1 0.887624777830639, Dice:0.8998253848895956, Haus:53.6509105014268
testA: F1 0.9270668919466368, Dice:0.9213513671106093, Haus:35.388117380119006
testB: F1 0.769298435482646, Dice:0.8352474382265553, Haus:108.4392898653502
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1199.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_699.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_Dice_0.8998_iter_1199.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_Dice_0.8974_iter_599.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testA_F1_0.9271_iter_1199.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testA_F1_0.9248_iter_599.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testA_Dice_0.9214_iter_1199.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testA_Dice_0.9182_iter_99.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.8998253848895956, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9270668919466368, 'testA_Dice': 0.9213513671106093, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7815749579797568, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [1250/2000] Lr:0.002037 Total Loss:0.6071, Iter time:0.4957s Data loading time:0.0001s
Training Iter: [1300/2000] Lr:0.001939 Total Loss:0.5668, Iter time:0.6591s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:37, 11.47s/it] 10%|█         | 2/20 [00:18<02:37,  8.76s/it] 15%|█▌        | 3/20 [00:33<03:17, 11.63s/it] 20%|██        | 4/20 [00:48<03:27, 12.96s/it] 25%|██▌       | 5/20 [01:06<03:42, 14.87s/it] 30%|███       | 6/20 [01:12<02:47, 11.94s/it] 35%|███▌      | 7/20 [01:28<02:51, 13.18s/it] 40%|████      | 8/20 [01:42<02:39, 13.26s/it] 45%|████▌     | 9/20 [01:50<02:09, 11.80s/it] 50%|█████     | 10/20 [01:59<01:48, 10.84s/it] 55%|█████▌    | 11/20 [02:17<01:58, 13.20s/it] 60%|██████    | 12/20 [02:31<01:45, 13.19s/it] 65%|██████▌   | 13/20 [02:38<01:20, 11.45s/it] 70%|███████   | 14/20 [02:46<01:02, 10.45s/it] 75%|███████▌  | 15/20 [02:51<00:44,  8.86s/it] 80%|████████  | 16/20 [02:58<00:32,  8.16s/it] 85%|████████▌ | 17/20 [03:06<00:24,  8.16s/it] 90%|█████████ | 18/20 [03:12<00:14,  7.49s/it] 95%|█████████▌| 19/20 [03:18<00:07,  7.18s/it]100%|██████████| 20/20 [03:29<00:00,  8.34s/it]100%|██████████| 20/20 [03:29<00:00, 10.50s/it]
total: F1 0.8699430722715862, Dice:0.8879270454947333, Haus:57.313152779670645
testA: F1 0.896858426651709, Dice:0.9051558979961295, Haus:39.861766401425164
testB: F1 0.7891970091312197, Dice:0.8362404879905446, Haus:109.66731191440704
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1299.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_799.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_F1_0.7892_iter_1299.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_F1_0.7816_iter_99.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.8998253848895956, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9270668919466368, 'testA_Dice': 0.9213513671106093, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7891970091312197, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [1350/2000] Lr:0.001839 Total Loss:0.6161, Iter time:0.8080s Data loading time:0.0003s
Training Iter: [1400/2000] Lr:0.001739 Total Loss:0.8713, Iter time:0.8952s Data loading time:0.0001s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:18, 10.44s/it] 10%|█         | 2/20 [00:16<02:24,  8.01s/it] 15%|█▌        | 3/20 [00:43<04:43, 16.68s/it] 20%|██        | 4/20 [01:04<04:55, 18.44s/it] 25%|██▌       | 5/20 [01:21<04:28, 17.90s/it] 30%|███       | 6/20 [01:27<03:13, 13.79s/it] 35%|███▌      | 7/20 [01:43<03:07, 14.40s/it] 40%|████      | 8/20 [01:56<02:46, 13.90s/it] 45%|████▌     | 9/20 [02:03<02:12, 12.01s/it] 50%|█████     | 10/20 [02:13<01:52, 11.22s/it] 55%|█████▌    | 11/20 [02:33<02:04, 13.88s/it] 60%|██████    | 12/20 [02:52<02:04, 15.54s/it] 65%|██████▌   | 13/20 [03:01<01:34, 13.48s/it] 70%|███████   | 14/20 [03:08<01:09, 11.66s/it] 75%|███████▌  | 15/20 [03:14<00:49,  9.80s/it] 80%|████████  | 16/20 [03:22<00:37,  9.31s/it] 85%|████████▌ | 17/20 [03:29<00:26,  8.69s/it] 90%|█████████ | 18/20 [03:38<00:17,  8.63s/it] 95%|█████████▌| 19/20 [03:46<00:08,  8.61s/it]100%|██████████| 20/20 [03:59<00:00,  9.92s/it]100%|██████████| 20/20 [03:59<00:00, 11.99s/it]
total: F1 0.871571594295507, Dice:0.8895950402692314, Haus:55.385195986712404
testA: F1 0.9033405548375059, Dice:0.9083710462249733, Haus:37.97446988434124
testB: F1 0.7762647126695116, Dice:0.8332670224020049, Haus:107.6173742938259
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1399.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_899.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.8998253848895956, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9270668919466368, 'testA_Dice': 0.9213513671106093, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7891970091312197, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [1450/2000] Lr:0.001638 Total Loss:0.6624, Iter time:0.5687s Data loading time:0.0002s
Training Iter: [1500/2000] Lr:0.001537 Total Loss:0.6384, Iter time:0.5396s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:23, 10.72s/it] 10%|█         | 2/20 [00:17<02:36,  8.69s/it] 15%|█▌        | 3/20 [00:36<03:43, 13.14s/it] 20%|██        | 4/20 [00:53<03:57, 14.85s/it] 25%|██▌       | 5/20 [01:11<03:55, 15.69s/it] 30%|███       | 6/20 [01:17<02:54, 12.47s/it] 35%|███▌      | 7/20 [01:32<02:52, 13.29s/it] 40%|████      | 8/20 [01:45<02:39, 13.28s/it] 45%|████▌     | 9/20 [01:53<02:09, 11.73s/it] 50%|█████     | 10/20 [02:03<01:49, 10.99s/it] 55%|█████▌    | 11/20 [02:20<01:56, 12.95s/it] 60%|██████    | 12/20 [02:34<01:45, 13.18s/it] 65%|██████▌   | 13/20 [02:42<01:20, 11.56s/it] 70%|███████   | 14/20 [02:50<01:02, 10.46s/it] 75%|███████▌  | 15/20 [02:56<00:45,  9.12s/it] 80%|████████  | 16/20 [03:03<00:34,  8.69s/it] 85%|████████▌ | 17/20 [03:10<00:24,  8.15s/it] 90%|█████████ | 18/20 [03:17<00:15,  7.78s/it] 95%|█████████▌| 19/20 [03:25<00:07,  7.86s/it]100%|██████████| 20/20 [03:39<00:00,  9.65s/it]100%|██████████| 20/20 [03:39<00:00, 10.97s/it]
total: F1 0.8775618631914069, Dice:0.8919690235286237, Haus:56.7763206439479
testA: F1 0.9107179744959633, Dice:0.9122133137106805, Haus:38.27047042147308
testB: F1 0.7780935292777399, Dice:0.8312361529824507, Haus:112.29387131137233
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1499.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_999.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.8998253848895956, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9270668919466368, 'testA_Dice': 0.9213513671106093, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7891970091312197, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [1550/2000] Lr:0.001434 Total Loss:0.7434, Iter time:0.7856s Data loading time:0.0002s
Training Iter: [1600/2000] Lr:0.001330 Total Loss:0.7235, Iter time:0.5006s Data loading time:0.0010s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:14, 10.23s/it] 10%|█         | 2/20 [00:18<02:47,  9.31s/it] 15%|█▌        | 3/20 [00:49<05:21, 18.89s/it] 20%|██        | 4/20 [01:04<04:41, 17.59s/it] 25%|██▌       | 5/20 [01:26<04:43, 18.91s/it] 30%|███       | 6/20 [01:32<03:25, 14.68s/it] 35%|███▌      | 7/20 [01:48<03:16, 15.12s/it] 40%|████      | 8/20 [02:00<02:50, 14.23s/it] 45%|████▌     | 9/20 [02:09<02:17, 12.48s/it] 50%|█████     | 10/20 [02:20<01:58, 11.90s/it] 55%|█████▌    | 11/20 [02:35<01:57, 13.01s/it] 60%|██████    | 12/20 [02:49<01:46, 13.32s/it] 65%|██████▌   | 13/20 [02:58<01:24, 12.04s/it] 70%|███████   | 14/20 [03:06<01:04, 10.74s/it] 75%|███████▌  | 15/20 [03:12<00:46,  9.27s/it] 80%|████████  | 16/20 [03:19<00:35,  8.75s/it] 85%|████████▌ | 17/20 [03:27<00:25,  8.51s/it] 90%|█████████ | 18/20 [03:35<00:16,  8.17s/it] 95%|█████████▌| 19/20 [03:44<00:08,  8.46s/it]100%|██████████| 20/20 [03:57<00:00,  9.96s/it]100%|██████████| 20/20 [03:57<00:00, 11.89s/it]
total: F1 0.871585967129017, Dice:0.8946061558338178, Haus:54.79132317351819
testA: F1 0.9066588286328957, Dice:0.9135941248659226, Haus:37.6399265432041
testB: F1 0.7663673826173827, Dice:0.8376422487375036, Haus:106.24551306446037
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1599.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1099.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.8998253848895956, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9270668919466368, 'testA_Dice': 0.9213513671106093, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7891970091312197, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [1650/2000] Lr:0.001225 Total Loss:0.6642, Iter time:0.8735s Data loading time:0.0002s
Training Iter: [1700/2000] Lr:0.001118 Total Loss:0.6655, Iter time:0.6674s Data loading time:0.0001s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:36, 11.41s/it] 10%|█         | 2/20 [00:19<02:50,  9.48s/it] 15%|█▌        | 3/20 [00:44<04:39, 16.42s/it] 20%|██        | 4/20 [01:10<05:24, 20.29s/it] 25%|██▌       | 5/20 [01:33<05:20, 21.40s/it] 30%|███       | 6/20 [01:40<03:47, 16.26s/it] 35%|███▌      | 7/20 [01:58<03:39, 16.90s/it] 40%|████      | 8/20 [02:11<03:08, 15.67s/it] 45%|████▌     | 9/20 [02:19<02:27, 13.43s/it] 50%|█████     | 10/20 [02:30<02:04, 12.50s/it] 55%|█████▌    | 11/20 [02:48<02:07, 14.16s/it] 60%|██████    | 12/20 [03:01<01:51, 13.89s/it] 65%|██████▌   | 13/20 [03:10<01:27, 12.53s/it] 70%|███████   | 14/20 [03:19<01:07, 11.23s/it] 75%|███████▌  | 15/20 [03:24<00:47,  9.50s/it] 80%|████████  | 16/20 [03:31<00:34,  8.73s/it] 85%|████████▌ | 17/20 [03:38<00:24,  8.29s/it] 90%|█████████ | 18/20 [03:46<00:16,  8.08s/it] 95%|█████████▌| 19/20 [03:55<00:08,  8.35s/it]100%|██████████| 20/20 [04:10<00:00, 10.32s/it]100%|██████████| 20/20 [04:10<00:00, 12.51s/it]
total: F1 0.885224475529105, Dice:0.8977732842843759, Haus:53.406616980185234
testA: F1 0.9244875181754253, Dice:0.9186164286017948, Haus:35.00976044713457
testB: F1 0.7674353475901464, Dice:0.8352438513321182, Haus:108.59718657933732
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1699.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1199.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.8998253848895956, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9270668919466368, 'testA_Dice': 0.9213513671106093, 'testA_Haus': 34.10161511690486, 'testB_F1': 0.7891970091312197, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [1750/2000] Lr:0.001009 Total Loss:0.7090, Iter time:2.1518s Data loading time:1.2535s
Training Iter: [1800/2000] Lr:0.000898 Total Loss:0.5885, Iter time:0.5487s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:13<04:10, 13.19s/it] 10%|█         | 2/20 [00:21<03:08, 10.48s/it] 15%|█▌        | 3/20 [00:40<04:05, 14.42s/it] 20%|██        | 4/20 [01:09<05:20, 20.03s/it] 25%|██▌       | 5/20 [01:30<05:03, 20.25s/it] 30%|███       | 6/20 [01:36<03:38, 15.60s/it] 35%|███▌      | 7/20 [01:54<03:30, 16.20s/it] 40%|████      | 8/20 [02:07<03:04, 15.38s/it] 45%|████▌     | 9/20 [02:16<02:26, 13.33s/it] 50%|█████     | 10/20 [02:26<02:02, 12.21s/it] 55%|█████▌    | 11/20 [02:43<02:03, 13.77s/it] 60%|██████    | 12/20 [02:59<01:54, 14.27s/it] 65%|██████▌   | 13/20 [03:07<01:27, 12.50s/it] 70%|███████   | 14/20 [03:17<01:10, 11.72s/it] 75%|███████▌  | 15/20 [03:23<00:49,  9.99s/it] 80%|████████  | 16/20 [03:31<00:37,  9.34s/it] 85%|████████▌ | 17/20 [03:38<00:26,  8.80s/it] 90%|█████████ | 18/20 [03:46<00:16,  8.39s/it] 95%|█████████▌| 19/20 [03:55<00:08,  8.73s/it]100%|██████████| 20/20 [04:10<00:00, 10.66s/it]100%|██████████| 20/20 [04:10<00:00, 12.54s/it]
total: F1 0.8813255642892013, Dice:0.898626297313972, Haus:53.680910768417576
testA: F1 0.9181140908130273, Dice:0.921025361783369, Haus:34.070550951344494
testB: F1 0.7709599847177248, Dice:0.8314291039057806, Haus:112.51199021963676
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1799.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1299.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testA_Haus_34.0706_iter_1799.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testA_Haus_34.1016_iter_99.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.8998253848895956, 'total_Haus': 53.23338888577551, 'testA_F1': 0.9270668919466368, 'testA_Dice': 0.9213513671106093, 'testA_Haus': 34.070550951344494, 'testB_F1': 0.7891970091312197, 'testB_Dice': 0.840068440434052, 'testB_Haus': 105.77270935039925}
Training Iter: [1850/2000] Lr:0.000785 Total Loss:0.6559, Iter time:0.6049s Data loading time:0.0043s
Training Iter: [1900/2000] Lr:0.000667 Total Loss:0.6587, Iter time:1.7547s Data loading time:1.3743s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<03:07,  9.86s/it] 10%|█         | 2/20 [00:18<02:47,  9.30s/it] 15%|█▌        | 3/20 [00:48<05:16, 18.63s/it] 20%|██        | 4/20 [01:13<05:38, 21.16s/it] 25%|██▌       | 5/20 [01:33<05:08, 20.57s/it] 30%|███       | 6/20 [01:40<03:43, 15.96s/it] 35%|███▌      | 7/20 [01:58<03:36, 16.65s/it] 40%|████      | 8/20 [02:13<03:14, 16.20s/it] 45%|████▌     | 9/20 [02:22<02:32, 13.88s/it] 50%|█████     | 10/20 [02:32<02:06, 12.65s/it] 55%|█████▌    | 11/20 [02:46<01:59, 13.23s/it] 60%|██████    | 12/20 [03:00<01:47, 13.49s/it] 65%|██████▌   | 13/20 [03:08<01:22, 11.84s/it] 70%|███████   | 14/20 [03:16<01:03, 10.56s/it] 75%|███████▌  | 15/20 [03:22<00:46,  9.30s/it] 80%|████████  | 16/20 [03:30<00:35,  8.83s/it] 85%|████████▌ | 17/20 [03:37<00:24,  8.21s/it] 90%|█████████ | 18/20 [03:43<00:15,  7.78s/it] 95%|█████████▌| 19/20 [03:54<00:08,  8.59s/it]100%|██████████| 20/20 [04:08<00:00, 10.33s/it]100%|██████████| 20/20 [04:08<00:00, 12.44s/it]
total: F1 0.885729065789854, Dice:0.8988648688528231, Haus:52.988307893031504
testA: F1 0.9164830565125083, Dice:0.9181926074868937, Haus:35.93892785380932
testB: F1 0.7934670936218925, Dice:0.8408816529506108, Haus:104.13644801069809
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1899.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1399.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_Haus_52.9883_iter_1899.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_total_Haus_53.2334_iter_599.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_F1_0.7935_iter_1899.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_F1_0.7892_iter_1299.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Dice_0.8409_iter_1899.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Dice_0.8401_iter_599.pt
saving best checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Haus_104.1364_iter_1899.pt
deleting best checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/best_testB_Haus_105.7727_iter_399.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.8998253848895956, 'total_Haus': 52.988307893031504, 'testA_F1': 0.9270668919466368, 'testA_Dice': 0.9213513671106093, 'testA_Haus': 34.070550951344494, 'testB_F1': 0.7934670936218925, 'testB_Dice': 0.8408816529506108, 'testB_Haus': 104.13644801069809}
Training Iter: [1950/2000] Lr:0.000543 Total Loss:0.6093, Iter time:2.0691s Data loading time:1.6788s
Training Iter: [2000/2000] Lr:0.000400 Total Loss:0.6353, Iter time:0.5641s Data loading time:0.0002s
evaluating.........
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:19, 10.52s/it] 10%|█         | 2/20 [00:18<02:40,  8.90s/it] 15%|█▌        | 3/20 [00:37<03:48, 13.44s/it] 20%|██        | 4/20 [01:02<04:47, 17.98s/it] 25%|██▌       | 5/20 [01:21<04:34, 18.33s/it] 30%|███       | 6/20 [01:27<03:21, 14.38s/it] 35%|███▌      | 7/20 [01:45<03:20, 15.40s/it] 40%|████      | 8/20 [01:58<02:55, 14.66s/it] 45%|████▌     | 9/20 [02:06<02:17, 12.49s/it] 50%|█████     | 10/20 [02:17<02:00, 12.05s/it] 55%|█████▌    | 11/20 [02:33<01:59, 13.27s/it] 60%|██████    | 12/20 [02:47<01:48, 13.55s/it] 65%|██████▌   | 13/20 [02:55<01:22, 11.84s/it] 70%|███████   | 14/20 [03:03<01:03, 10.62s/it] 75%|███████▌  | 15/20 [03:08<00:45,  9.17s/it] 80%|████████  | 16/20 [03:16<00:34,  8.65s/it] 85%|████████▌ | 17/20 [03:23<00:24,  8.25s/it] 90%|█████████ | 18/20 [03:30<00:15,  7.92s/it] 95%|█████████▌| 19/20 [03:39<00:08,  8.27s/it]100%|██████████| 20/20 [03:54<00:00, 10.08s/it]100%|██████████| 20/20 [03:54<00:00, 11.71s/it]
total: F1 0.8685351022298603, Dice:0.8925908459898066, Haus:54.60090886208975
testA: F1 0.9048140590515493, Dice:0.9112959094808316, Haus:37.32729025389129
testB: F1 0.7596982317647953, Dice:0.8364756555167314, Haus:106.42176468668512
saving checkpoint file to /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1999.pt
deleting checkpoint file /data/ssd1/xuxinan/mm/checkpoints/unet_branch_SGD_473_Saturday_04_January_2025_22h_54m_08s/iter_1499.pt
best value: {'total_F1': 0.8885861831095502, 'total_Dice': 0.8998253848895956, 'total_Haus': 52.988307893031504, 'testA_F1': 0.9270668919466368, 'testA_Dice': 0.9213513671106093, 'testA_Haus': 34.070550951344494, 'testB_F1': 0.7934670936218925, 'testB_Dice': 0.8408816529506108, 'testB_Haus': 104.13644801069809}
